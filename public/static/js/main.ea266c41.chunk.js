(this["webpackJsonpfront-poker"]=this["webpackJsonpfront-poker"]||[]).push([[0],{106:function(e,t,a){"use strict";(function(e){var r=a(31),n=a(16),s=a(19),i=a(18),o=a(17),c=a(1),l=a(65),u=a(79),d=a(20),m=a(33),p=(a(53),a(2)),h=function(t){Object(i.a)(c,t);var a=Object(o.a)(c);function c(e){var t;Object(n.a)(this,c),(t=a.call(this,e)).onReaderLoad=function(e){t.setState({image:e.target.result})},t.readURL=function(e){if(e.preventDefault(),e.target.files&&e.target.files[0]){var a=new FileReader;a.onload=t.onReaderLoad,a.readAsDataURL(e.target.files[0])}},t.uploadImage=function(){var e=t.props,a=e.updateImage,r=e.uploadImage,n=e.close,s=t.state,i=s.image,o={playerIds:s.playerIds,groupIds:s.groupIds,gameIds:s.gameIds};t.setState({uploading:!0}),r(i,o).then((function(e){t.setState({showSuccess:!0,uploading:!1}),a(e),setTimeout((function(){n()}),10)})).catch((function(){t.setState({showError:!0,uploading:!1}),setTimeout((function(){t.setState({showError:null}),n()}),10)}))},t.handleNewPlayerChange=function(e){t.setState({taggedPlayerId:e})},t.removePlayerTag=function(e){var a=Object(r.a)(t.state.playerIds).filter((function(t){return t!==e}));t.setState({playerIds:a})},t.tagPlayer=function(){if(t.state.taggedPlayerId){var e=Object(r.a)(t.state.playerIds);e.push(t.state.taggedPlayerId);var a=null;if(t.props.group){var n=t.props.group.players.filter((function(t){return!e.includes(t.id)}));n.length>0&&(a=n[0].id)}t.setState({taggedPlayerId:a,playerIds:e})}};var s={taggedPlayerId:null,image:null,playerIds:[],groupIds:[],gameIds:[],showError:null,showSuccess:null,uploading:!1};if(e.group&&(s.groupIds=[e.group.id]),e.gameId&&(s.gameIds=[e.gameId]),e.group&&e.gameId){var i=e.group.games.find((function(t){return t.id===e.gameId}));i&&i.playersData&&i.playersData.length>0&&(s.taggedPlayerId=i.playersData[0].playerId)}return t.state=s,t}return Object(s.a)(c,[{key:"render",value:function(){var t=this,a=this.state,r=a.showError,n=a.showSuccess,s=a.uploading,i=this.props.group,o=this.state,c=o.image,h=o.groupIds,g=o.gameIds,j=o.playerIds,b="",f="",v=[];if(i&&h[0]===i.id&&(b=i.name),1===g.length){var O=i.games.find((function(e){return e.id===g[0]}));f=O?O.date.AsGameName():""}i&&j.length>0&&(v=i.players.filter((function(e){return j.includes(e.id)})).map((function(e){return Object(p.jsxs)("ul",{children:[e.name," ",Object(p.jsx)("button",{onClick:function(){return t.removePlayerTag(e.id)},children:"remove tag"})]},"_tag_".concat(e.id))})));var y=Object(p.jsx)("div",{});if(i&&c){var x=i.players.filter((function(e){return!j.includes(e.id)})).map((function(e){return{id:e.id,name:e.name}}));if(x.length>0){this.state.taggedPlayerId||e((function(){return t.setState({taggedPlayerId:x[0].id})}));var w=x.map((function(e){return Object(p.jsx)("option",{value:e.id,children:e.name},"_x_comboVals_".concat(e.id))}));y=Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{children:"add players tags:"}),Object(p.jsx)("select",{name:"player",value:this.state.taggedPlayerId||"",onChange:function(e){return t.handleNewPlayerChange(e.target.value)},children:w}),Object(p.jsx)(d.a,{className:"button left-margin",disabled:!this.state.taggedPlayerId,onClick:this.tagPlayer,children:" Tag player"})]})}}return Object(p.jsxs)("div",{id:"image-uploader",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{children:"choose image:"}),Object(p.jsx)("div",{children:Object(p.jsx)("input",{type:"file",accept:".png,.jpg,.jpeg",id:"imgInput",onChange:this.readURL})}),Object(p.jsx)("div",{children:c&&Object(p.jsx)("img",{alt:"image",id:"image-uploader-preview",src:c})}),!c&&Object(p.jsx)("div",{children:"no image selected yet"})]}),h.length>0&&Object(p.jsxs)("div",{children:[" Tagging the group (",b,")"]}),g.length>0&&Object(p.jsxs)("div",{children:[" Tagging the game (",f,")"]}),j.length>0&&Object(p.jsx)("div",{children:" Tagging players:"}),v.length>0&&Object(p.jsxs)("div",{children:[" ",v]}),Object(p.jsx)("hr",{}),y,Object(p.jsxs)("div",{children:[s&&Object(p.jsx)("div",{children:"please wait.."}),Object(p.jsx)(m.a,{className:"button",disabled:!c||s,onClick:this.uploadImage,children:" Upload "})]}),Object(p.jsx)("div",{children:Object(p.jsx)(d.a,{className:"button",disabled:s,onClick:this.props.close,children:" cancel "})}),r&&Object(p.jsx)(l.a,{message:"failed to upload image"}),n&&Object(p.jsx)(u.a,{message:"image uploaded successfully"})]})}}]),c}(c.Component);t.a=h}).call(this,a(112).setImmediate)},132:function(e,t,a){"use strict";var r=a(5),n=a.n(r),s=a(7),i=a(14),o=a.n(i),c=a(15);function l(){return(l=Object(s.a)(n.a.mark((function e(t,a,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var s={url:"".concat(c.a,"/notifications"),method:"POST",body:JSON.stringify(t),headers:{provider:a,"x-auth-token":r,"Content-Type":"application/json"}};console.log("registerSubscription",s.method,s.url,s.body),o()(s,(function(t,s,i){if(t||s.statusCode>=400){if(t)return console.error("request cb error",t),n("failed to registerSubscription , server might be down");var o=JSON.parse(i);return console.error("request cb error body",o),n(o.title)}if(s&&s.headers&&s.headers["x-user-context"]){var c=s.headers["x-user-context"],l=JSON.parse(decodeURI(c)),u=JSON.parse(i);return console.log("got data:",u),e({data:u,userContext:l,provider:a,token:r})}return console.error("request cb no header"),n("server response is missing the user context")}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var u=function(e,t,a){return l.apply(this,arguments)};function d(){return(d=Object(s.a)(n.a.mark((function e(t,a,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var n={url:"".concat(c.a,"/notifications"),method:"DELETE",headers:{provider:a,"x-auth-token":r,"Content-Type":"application/json"}};console.log("unregisterSubscription",n.method,n.url,n.body),o()(n,(function(n,s,i){if(n||s.statusCode>=400){if(n)return console.error("request cb error",n),t("failed to unregisterSubscription , server might be down");var o=JSON.parse(i);return console.error("request cb error body",o),t(o.title)}if(s&&s.headers&&s.headers["x-user-context"]){var c=s.headers["x-user-context"],l=JSON.parse(decodeURI(c)),u=JSON.parse(i);return console.log("got data:",u),e({data:u,userContext:l,provider:a,token:r})}return console.error("request cb no header"),t("server response is missing the user context")}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=function(e,t,a){return d.apply(this,arguments)},p=!1,h=null,g=!0;var j=localStorage.getItem("subscription");function b(){return(b=Object(s.a)(n.a.mark((function e(t,a,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(t,a,r);case 2:localStorage.setItem("subscription",JSON.stringify(t));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return(f=Object(s.a)(n.a.mark((function e(t,a,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t,a,r);case 2:localStorage.removeItem("subscription");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}j&&(j=JSON.parse(j),p=!0),"serviceWorker"in navigator&&"PushManager"in window?navigator.serviceWorker.register("service-worker.js").then((function(e){h=e})).catch((function(e){console.error("Service Worker Error",e),g=!1})):(console.warn("Push messaging is not supported"),g=!1);t.a={IsSubscribed:function(){return p},IsPushSupported:function(){return g},subscribeUser:function(e,t){if(!p&&g){var a=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),a=window.atob(t),r=new Uint8Array(a.length),n=0;n<a.length;++n)r[n]=a.charCodeAt(n);return r}("BIzamkxmxtu3jgxzUVL3Pg7AKbbxv2y8dLPPePT6fxXVI9Nl4wBJJpGeTAEofw0etXweRs8COyNrRJ5Aw2lhmXg");return h.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:a}).then((function(a){!function(e,t,a){b.apply(this,arguments)}(a,e,t),p=!0}))}},unsubscribeUser:function(e,t){if(localStorage.removeItem("subscription"),p)return h.pushManager.getSubscription().then((function(a){if(a)return function(e,t,a){f.apply(this,arguments)}(a,e,t),a.unsubscribe()}))}}},15:function(e,t,a){"use strict";var r="".concat(window.location.origin,"/api/v2");"http://localhost:3000/api/v2"===r&&(r="http://www.poker-stats.com/api/v2"),t.a=r},168:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var r=a(16),n=a(19),s=a(18),i=a(17),o=a(1),c=a(63),l=a(2),u=function(e){Object(s.a)(a,e);var t=Object(i.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(n.a)(a,[{key:"render",value:function(){var e=Object(l.jsx)("i",{className:"emSvgSize em-svg em-hearts"}),t=Object(l.jsx)("i",{className:"emSvgSizeBigger em-svg em-spades"}),a=Object(l.jsx)("i",{className:"emSvgSizeBigger em-svg em-diamonds"}),r=Object(l.jsx)("i",{className:"emSvgSizeBigger em-svg em-clubs"});return Object(l.jsxs)("div",{id:"loader",children:[Object(l.jsxs)("div",{className:"app-version",children:["V.",c.a]}),Object(l.jsxs)("div",{className:"loader",children:[Object(l.jsx)("span",{id:"loaderSpan1",className:"loaderSpan",children:e}),Object(l.jsx)("span",{id:"loaderSpan2",className:"loaderSpan",children:t}),Object(l.jsx)("span",{id:"loaderSpan3",className:"loaderSpan",children:a}),Object(l.jsx)("span",{id:"loaderSpan4",className:"loaderSpan",children:r})]})]})}}]),a}(o.Component)},20:function(e,t,a){"use strict";var r=a(4),n=(a(1),a(2));t.a=function(e){return Object(n.jsxs)("button",Object(r.a)(Object(r.a)({},e),{},{className:"".concat(e.className," confetti-button confetti-button-gray"),onClick:function(t){t.preventDefault();try{t.target.classList.remove("animate")}catch(t){}try{t.target.classList.add("animate")}catch(t){}setTimeout((function(){try{t.target.classList.remove("animate")}catch(t){}}),700),setTimeout((function(){try{e.onClick(t)}catch(t){}}),500)},children:[" ",e.children]}))}},250:function(e,t,a){"use strict";var r=a(103),n=a(4),s=a(16),i=a(19),o=a(18),c=a(17),l=a(1),u=a(416),d=a(81),m=a(105),p=a.n(m),h=a(20),g=a(33),j=a(53),b=a(63),f=a(2),v=function(e){Object(o.a)(a,e);var t=Object(c.a)(a);function a(e){var i;return Object(s.a)(this,a),(i=t.call(this,e)).handleGroupItemChange=function(e,t){var a=Object(n.a)(Object(n.a)({},i.state.group),{},Object(r.a)({},e,t));i.setState({group:a})},i.cancel=function(){i.setState({showMenu:!1}),i.props.onCancel()},i.logout=function(){i.setState({showMenu:!1}),i.props.logout()},i.delete=function(){i.setState({showMenu:!1}),i.props.delete(i.state.group.id)},i.getHeader=function(){var e=[];e.push(Object(f.jsx)(d.a,{onClick:i.cancel,children:"Cancel"},"menuItem1")),i.state.update&&e.push(Object(f.jsx)(d.a,{onClick:i.delete,children:"Delete"},"menuItem3")),e.push(Object(f.jsx)(d.a,{onClick:i.logout,children:"Logout"},"menuItem5")),e.push(Object(f.jsx)(d.a,{onClick:function(){},children:Object(f.jsxs)("div",{children:[Object(f.jsx)("hr",{})," ",Object(f.jsx)("span",{className:"version-menu-item-text",children:"version: "}),Object(f.jsx)("span",{className:"version-menu-item-number",children:b.a})]})},"menuItem6"));var t=Object(f.jsx)(p.a,{id:"menuIcon",fontSize:"inherit",className:"menu-icon",onClick:function(){return i.setState({showMenu:!i.state.showMenu})}});return Object(f.jsxs)("div",{id:"app-header",children:[t,i.state.showMenu&&Object(f.jsx)(u.a,{id:"simple-menu",anchorEl:function(){return document.getElementById("menuIcon")},keepMounted:!0,open:!0,onClose:function(){return i.setState({showMenu:!i.state.showMenu})},children:e}),Object(f.jsxs)("span",{id:"app-header-text",children:[i.state.update?"Update":"Create"," Group"]})]})},i.state={showMenu:!1,error:null,group:e.group||{name:"",description:""},update:e.isUpdate},i}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.getHeader(),a=this.state.group.name.length>0;return Object(f.jsxs)("div",{id:"create-group-form container",children:[t,Object(f.jsxs)("div",{id:"create-group-form-wrapper",children:[Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("span",{className:"new-group-form-item-label",children:"Name*"})}),Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("input",{type:"text",placeholder:"Enter group name",id:"newGroupTitle",className:"formTextInput-full-width",value:this.state.group.name,onChange:function(t){return e.handleGroupItemChange("name",t.target.value)}})}),Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("span",{className:"new-group-form-item-label",children:"Description"})}),Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("input",{type:"text",placeholder:"Enter description",id:"newGroupDescription",className:"formTextInput-full-width",value:this.state.group.description,onChange:function(t){return e.handleGroupItemChange("description",t.target.value)}})}),Object(f.jsxs)("div",{className:"row top-margin",children:[Object(f.jsx)(h.a,{className:"button left-pad",onClick:this.props.onCancel,children:" Cancel "}),Object(f.jsx)(g.a,{className:"button left-pad left-margin",onClick:function(){return e.props.saveGroup(e.state.group)},disabled:!a,children:this.state.update?"update":"save"}),this.state.update&&Object(f.jsx)(j.a,{className:"button left-pad left-margin",onClick:function(){return e.props.deleteGroup(e.state.group.id)},disabled:!a,children:" delete"})]})]})]})}}]),a}(l.Component);t.a=v},33:function(e,t,a){"use strict";var r=a(4),n=(a(1),a(2));t.a=function(e){return Object(n.jsxs)("button",Object(r.a)(Object(r.a)({},e),{},{className:"".concat(e.className," confetti-button confetti-button-green"),onClick:function(t){t.preventDefault();try{t.target.classList.remove("animate")}catch(t){}try{t.target.classList.add("animate")}catch(t){}setTimeout((function(){try{t.target.classList.remove("animate")}catch(t){}}),700),setTimeout((function(){try{e.onClick(t)}catch(t){}}),500)},children:[" ",e.children]}))}},390:function(e,t,a){"use strict";(function(e){var r=a(4),n=a(31),s=a(5),i=a.n(s),o=a(7),c=a(16),l=a(19),u=a(18),d=a(17),m=a(1),p=a(391),h=a.n(p),g=a(392),j=a(393),b=a(394),f=a(395),v=a(396),O=a(397),y=a(414),x=a(415),w=a(250),G=a(412),I=a(416),S=a(81),N=a(105),C=a.n(N),k=a(168),P=a(410),D=a(132),E=a(63),T=a(2),A=D.a.IsSubscribed,U=D.a.IsPushSupported,M=D.a.subscribeUser,B=D.a.unsubscribeUser;Date.prototype.AsGameName=function(){var e=this.toISOString().substr(0,10),t=e.substr(8,2),a=e.substr(5,2),r=e.substr(0,4);return"".concat(t,"/").concat(a,"/").concat(r)},Date.prototype.AsExactTime=function(){return this.toISOString().substr(11,5)},String.prototype.AsGameName=function(){return new Date(this).AsGameName()},String.prototype.AsExactTime=function(e){return h()(this).add(e,"hours").toDate().AsExactTime()};var F=function(t){Object(u.a)(s,t);var a=Object(d.a)(s);function s(){var t;return Object(c.a)(this,s),(t=a.call(this)).onNotificationButtonClick=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,console.log("onNotificationButtonClick this.state.subscribed",t.state.subscribed),!t.state.subscribed){e.next=8;break}return e.next=5,B(t.state.provider,t.state.token);case 5:t.setState({subscribed:!1,showMenu:!1}),e.next=11;break;case 8:return e.next=10,M(t.state.provider,t.state.token);case 10:t.setState({subscribed:!0,showMenu:!1});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("onNotificationButtonClick Error",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])}))),t.logout=function(){localStorage.removeItem("authData"),t.setState({isAuthenticated:!1,user:null,events:[],error:null,showMenu:!1}),window.location.replace("https://www.poker-stats.com")},t.createGroup=function(){t.setState({showGroupCreationForm:!0,error:null,showMenu:!1})},t.onCancel=function(){console.log("onCancel"),t.setState({showGroupCreationForm:!1,showGroupEditForm:null,error:null,showMenu:!1})},t.onFailure=function(e){console.error("App onFailure",e),t.setState({error:e})},t.backToMainPage=function(){t.setState({group:null,players:null,games:null,error:null})},t.onLogin=function(){var e=Object(o.a)(i.a.mark((function e(a){var r,n,s,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a.userContext,n=a.provider,s=a.token,o=a.groups,t.setState({user:r,groups:o,loading:!1,isAuthenticated:!0,error:null,provider:n,token:s}),setInterval(g.a,3e5);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getHeader=function(){var e=[];U()&&e.push(Object(T.jsxs)(S.a,{onClick:t.onNotificationButtonClick,children:[t.state.subscribed?"disable":"enable"," notifications"]},"menuItem1")),e.push(Object(T.jsx)(S.a,{onClick:t.createGroup,children:"Create New Group"},"menuItem2")),e.push(Object(T.jsx)(S.a,{onClick:t.logout,children:"Logout"},"menuItem3")),e.push(Object(T.jsx)(S.a,{onClick:function(){},children:Object(T.jsxs)("div",{children:[Object(T.jsx)("hr",{})," ",Object(T.jsx)("span",{className:"version-menu-item-text",children:"version: "}),Object(T.jsx)("span",{className:"version-menu-item-number",children:E.a})]})},"menuItem6"));var a=Object(T.jsx)(C.a,{id:"menuIcon",fontSize:"inherit",className:"menu-icon",onClick:function(){return t.setState({showMenu:!t.state.showMenu})}});return Object(T.jsxs)("div",{id:"app-header",children:[a,t.state.showMenu&&Object(T.jsx)(I.a,{id:"simple-menu",anchorEl:function(){return document.getElementById("menuIcon")},keepMounted:!0,open:!0,onClose:function(){return t.setState({showMenu:!t.state.showMenu})},children:e}),Object(T.jsxs)("span",{id:"app-header-text",children:[Object(T.jsx)("img",{src:"pokerStatsLogoWithSheep.png",className:"sheep-logo",alt:""})," Groups"]})]})},t.updateExistingGroup=function(a){t.setState({loading:!0,error:null}),e(Object(o.a)(i.a.mark((function e(){var r,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(b.a)(a.id,a,t.state.provider,t.state.token);case 3:r=e.sent,s=[r].concat(Object(n.a)(t.state.groups)),t.setState({loading:!1,groups:s,showGroupEditForm:null,showGroupCreationForm:null}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t.setState({loading:!1,error:e.t0,showGroupEditForm:null,showGroupCreationForm:null});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))))},t.createNewGroup=function(a){e(Object(o.a)(i.a.mark((function e(){var r,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(j.a)(a,t.state.provider,t.state.token);case 3:r=e.sent,s=[r].concat(Object(n.a)(t.state.groups)),t.setState({loading:!1,groups:s}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t.setState({loading:!1,error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))))},t.saveGroup=function(e){t.setState({showGroupCreationForm:!1,error:null,loading:!0}),e.id?t.updateExistingGroup(e):t.createNewGroup(e)},t.delGroup=function(a){confirm("Are you sure?")?(t.setState({error:null,loading:!0}),e(Object(o.a)(i.a.mark((function e(){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(f.a)(a,t.state.provider,t.state.token);case 3:r=e.sent,n=t.state.groups.filter((function(e){return e.id!==r})),t.setState({loading:!1,groups:n,showGroupEditForm:null,showGroupCreationForm:null}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("error calling delete",e.t0),t.setState({loading:!1,error:e.t0,showGroupEditForm:null,showGroupCreationForm:null});case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))))):t.setState({showGroupEditForm:null,showGroupCreationForm:null})},t.goHome=function(){t.setState({showMenu:!1,showGroupCreationForm:!1,loading:!1,showGroupPage:null,showGroupEditForm:null})},t.showGroup=function(){var e=Object(o.a)(i.a.mark((function e(a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.userInGroup?(t.setState({showMenu:!1,loading:!0}),Object(O.a)(a,t.state.provider,t.state.token).then((function(e){e.players=e.players.map((function(t){var a=0,n=e.games.filter((function(e){var r=e.playersData.find((function(e){return e.playerId===t.id}));return r&&(a+=r.cashOut,a-=r.buyIn),r})).length;return Object(r.a)(Object(r.a)({},t),{},{gamesCount:n,balance:a})})).sort((function(e,t){return e.gamesCount===t.gamesCount?e.balance>t.balance?-1:1:e.gamesCount>t.gamesCount?-1:1})),t.setState({showGroupPage:e,loading:!1})})).catch((function(e){t.setState({error:e,loading:!1})}))):a.invitationRequested?(t.setState({showMenu:!1}),alert("invitation already requested. you will get an answer in your email.")):confirm("You sre not in this group. would you like to ask for an invitation?")?(t.setState({loading:!0}),Object(v.a)(a.id,t.state.provider,t.state.token).then((function(){t.setState({loading:!1})}))):t.setState({showMenu:!1});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.editGroup=function(e){console.log("editGroup"),t.setState({showMenu:!1,showGroupEditForm:e})},t.createGame=function(e,a){t.setState({showMenu:!1,showCreateGameForm:{group:e,game:a}})},t.createPlayer=function(e,a){t.setState({showMenu:!1,showCreatePlayerForm:{group:e,player:a}})},t.updatePlayerData=function(e){console.log("updatePlayerData. new player data:",e);var a=Object(r.a)(Object(r.a)({},t.state.showGroupPage),{},{players:Object(n.a)(t.state.showGroupPage.players)}),s=!1;a.players=a.players.map((function(t){return t.id!==e.id?t:(s=!0,e)})),s||a.players.push(e),console.log("updatePlayerData. state before:",t.state.showGroupPage),console.log("updatePlayerData. state after:",a),t.setState({showGroupPage:a})},t.updatePlayerRemoved=function(e){console.log("app removed player",e);var a=Object(r.a)({},t.state.showGroupPage);a.players=a.players.filter((function(t){return t.id!==e})),t.setState({showGroupPage:a})},t.updateGame=function(e){var a=Object(r.a)({},t.state.showGroupPage),n=!1;a.games=a.games.map((function(t){return t.id!==e.id?t:(n=!0,"string"===typeof e.date&&(e.date=new Date(e.date)),e)})),n||("string"===typeof e.date&&(e.date=new Date(e.date)),a.games.push(e)),t.setState({showGroupPage:a})},t.removeGame=function(e){console.log("app game remove",e);var a=Object(r.a)({},t.state.showGroupPage);a.games=a.games.filter((function(t){return t.id!==e})),t.setState({showGroupPage:a})},t.updateImage=function(e){var a=Object(r.a)({},t.state.showGroupPage),s=!1;a.images=a.images.map((function(t){return t.id!==e.id||(s=!0),t})),s||(a.images=[e].concat(Object(n.a)(a.images))),t.setState({showGroupPage:a})},t.removeImage=function(e){var a=Object(r.a)({},t.state.showGroupPage);a.images=a.images.filter((function(t){return t.id!==e})),t.setState({showGroupPage:a})},t.state={showMenu:!1,subscribed:A(),showGroupCreationForm:!1,showCreateGameForm:!1,showCreatePlayerForm:!1,showGroupEditForm:null,loading:!1,isAuthenticated:!1,user:null,groups:null,provider:"",error:null,token:null,showGroupPage:null},t}return Object(l.a)(s,[{key:"render",value:function(){var e=this.state,t=e.loading,a=e.isAuthenticated,r=e.groups,n=e.showGroupCreationForm,s=e.showGroupPage,i=e.showGroupEditForm;if(window.location.search&&window.location.search.includes("postman"))return Object(T.jsx)(y.a,{});if(t)return Object(T.jsx)(k.a,{});if(!a)return Object(T.jsx)(x.a,{onLogin:this.onLogin});if(i)return Object(T.jsx)(w.a,{onCancel:this.onCancel,saveGroup:this.saveGroup,deleteGroup:this.delGroup,logout:this.logout,group:i,isUpdate:!0});if(s)return Object(T.jsx)(G.a,{goHome:this.goHome,group:s,user:this.state.user,updatePlayerRemoved:this.updatePlayerRemoved,updateGame:this.updateGame,updatePlayerData:this.updatePlayerData,editGroup:this.editGroup,deleteGroup:this.delGroup,removeGame:this.removeGame,updateImage:this.updateImage,removeImage:this.removeImage,provider:this.state.provider,token:this.state.token,logout:this.logout});if(n)return Object(T.jsx)(w.a,{onCancel:this.onCancel,saveGroup:this.saveGroup,logout:this.logout});var o=this.state.user&&"cd5d8442-9d26-4e90-9ec9-454e880a2b4f"===this.state.user.id,c=this.getHeader();return Object(T.jsxs)("div",{className:"App container",children:[Object(T.jsx)("div",{className:"errorSection",children:this.state.error}),c,Object(T.jsx)("div",{className:"MainSection",children:o?Object(T.jsx)("img",{id:"site-under-construction-image",src:"https://res.cloudinary.com/www-poker-stats-com/image/upload/v1620552184/under.png",alt:"under-construction"}):Object(T.jsx)(P.a,{createGroup:this.createGroup,groups:r,showGroup:this.showGroup})})]})}}]),s}(m.Component);t.a=F}).call(this,a(112).setImmediate)},392:function(e,t,a){"use strict";var r=a(5),n=a.n(r),s=a(7),i=a(14),o=a.n(i),c=a(15);function l(){return(l=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("keep server Alive "),e.abrupt("return",new Promise((function(e,t){var a={method:"GET",url:"".concat(c.a,"/keep-alive")};o()(a,(function(t,a,r){var n=JSON.parse(r);return e(n)}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.a=function(){return l.apply(this,arguments)}},393:function(e,t,a){"use strict";var r=a(5),n=a.n(r),s=a(7),i=a(14),o=a.n(i),c=a(15);function l(){return(l=Object(s.a)(n.a.mark((function e(t,a,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var s={method:"POST",url:"".concat(c.a,"/groups"),body:JSON.stringify(t),headers:{provider:a,"x-auth-token":r,"Content-Type":"application/json"}};o()(s,(function(t,a,r){if(t||a.statusCode>=400){if(t)return console.error("request cb error",t),n("failed to create new group");var s=JSON.parse(r);return console.error("failed to create new group"),n(s.title)}return e(JSON.parse(r))}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.a=function(e,t,a){return l.apply(this,arguments)}},394:function(e,t,a){"use strict";var r=a(5),n=a.n(r),s=a(7),i=a(14),o=a.n(i),c=a(15);function l(){return(l=Object(s.a)(n.a.mark((function e(t,a,r,s){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("updateGroup",t,a,r,s),e.abrupt("return",new Promise((function(e,n){var i={method:"PATCH",url:"".concat(c.a,"/groups/").concat(t),body:JSON.stringify(a),headers:{provider:r,"x-auth-token":s,"Content-Type":"application/json"}};o()(i,(function(t,a,r){if(t||a.statusCode>=400){if(t)return console.error("request cb error",t),n("failed to update group");var s=JSON.parse(r);return console.error("failed to update group"),n(s.title)}return e(JSON.parse(r))}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.a=function(e,t,a,r){return l.apply(this,arguments)}},395:function(e,t,a){"use strict";var r=a(5),n=a.n(r),s=a(7),i=a(14),o=a.n(i),c=a(15);function l(){return(l=Object(s.a)(n.a.mark((function e(t,a,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var s={method:"DELETE",url:"".concat(c.a,"/groups/").concat(t),headers:{provider:a,"x-auth-token":r,"Content-Type":"application/json"}};o()(s,(function(t,a,r){if(t||a.statusCode>=400){if(t)return console.error("request cb error",t),n("failed to delete group");var s=JSON.parse(r);return console.error("failed to delete group"),n(s.title)}return e()}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.a=function(e,t,a){return l.apply(this,arguments)}},396:function(e,t,a){"use strict";var r=a(5),n=a.n(r),s=a(7),i=a(14),o=a.n(i),c=a(15);function l(){return(l=Object(s.a)(n.a.mark((function e(t,a,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var s={method:"POST",url:"".concat(c.a,"/invitations-requests/"),headers:{provider:a,"x-auth-token":r,"Content-Type":"application/json"},body:JSON.stringify({requestedGroupId:t})};o()(s,(function(t,a,r){if(t||a.statusCode>=400){if(t)return console.error("request cb error",t),n("failed to requestInvitation",t);var s=JSON.parse(r);return console.error("failed to requestInvitation",s),n(s.title)}return e(JSON.parse(r))}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.a=function(e,t,a){return l.apply(this,arguments)}},397:function(e,t,a){"use strict";var r=a(5),n=a.n(r),s=a(4),i=a(7),o=a(14),c=a.n(o),l=a(15);function u(){return(u=Object(i.a)(n.a.mark((function e(t,a,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var i,o,u,d={method:"GET",url:"".concat(l.a,"/groups/").concat(t.id,"/players/"),headers:{provider:a,"x-auth-token":r,"Content-Type":"application/json"}},m={method:"GET",url:"".concat(l.a,"/groups/").concat(t.id,"/games/"),headers:{provider:a,"x-auth-token":r,"Content-Type":"application/json"}},p={method:"GET",url:"".concat(l.a,"/groups/").concat(t.id,"/images/"),headers:{provider:a,"x-auth-token":r,"Content-Type":"application/json"}};c()(d,(function(a,r,c){if(a||r.statusCode>=400){if(a)return console.error("request cb error.failed to get group players",a),n("failed to get group data");var l=JSON.parse(c);return console.error("failed to get group players",l),n(l.title)}if((o=JSON.parse(c).results)&&u&&i){var d=r.headers["x-user-context"],m=JSON.parse(decodeURI(d));return e(Object(s.a)(Object(s.a)({},t),{},{players:o,games:u,images:i,userContext:m}))}})),c()(m,(function(a,r,c){if(a||r.statusCode>=400){if(a)return console.error("request cb error.failed to get group games",a),n("failed to get group data");var l=JSON.parse(c);return console.error("failed to get group games",l),n(l.title)}if(u=JSON.parse(c).results.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{date:new Date(e.date)})})),o&&u&&i){var d=r.headers["x-user-context"],m=JSON.parse(decodeURI(d));return e(Object(s.a)(Object(s.a)({},t),{},{players:o,games:u,images:i,userContext:m}))}})),c()(p,(function(a,r,c){if(a||r.statusCode>=400){if(a)return console.error("request cb error.failed to get group images",a),n("failed to get group data");var l=JSON.parse(c);return console.error("failed to get group images",l),n(l.title)}if(i=JSON.parse(c).results,o&&u&&i){var d=r.headers["x-user-context"],m=JSON.parse(decodeURI(d));return e(Object(s.a)(Object(s.a)({},t),{},{players:o,games:u,images:i,userContext:m}))}}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.a=function(e,t,a){return u.apply(this,arguments)}},410:function(e,t,a){"use strict";var r=a(16),n=a(19),s=a(18),i=a(17),o=a(1),c=a(107),l=a(56),u=a(2),d=a(993),m=function(e){Object(s.a)(a,e);var t=Object(i.a)(a);function a(){var e;return Object(r.a)(this,a),(e=t.call(this)).getUserGroupsDiv=function(){var t=(e.props.groups||[]).filter((function(e){return e.userInGroup}));return e.getGroupsDiv({groups:t,showAddGroupItem:!0})},e.getOtherGroupsDiv=function(){var t=(e.props.groups||[]).filter((function(e){return!e.userInGroup}));return e.getGroupsDiv({groups:t,showAddGroupItem:!1})},e.onKeyChange=function(t){console.log("### tabKey",t),e.setState({tabKey:t})},e.imageIndex=0,e.imagesCount=7,e.clearGamesTabSelections=function(){},e.state={tabKey:"myGroups"},e}return Object(n.a)(a,[{key:"startIntro",value:function(){d().start()}},{key:"getImage",value:function(){return this.imageIndex++,this.imageIndex>this.imagesCount&&(this.imageIndex=1),"backgroundImage".concat(this.imageIndex,".jpg")}},{key:"getGroupsDiv",value:function(e){var t=this,a=e.groups,r=e.showAddGroupItem,n=a.map((function(e){var a={backgroundImage:"url(".concat(e.imageUrl||t.getImage(),")"),borderRadiusTop:"50px"};return Object(u.jsxs)("div",{className:"group-item-div ".concat(e.isAdmin?"group-item-div-admin":""),onClick:function(){return t.props.showGroup(e)},children:[Object(u.jsxs)("div",{className:"group-item-div-inner",style:a,children:[Object(u.jsx)("div",{children:Object(u.jsx)("b",{className:"text-shadow",children:e.name})}),Object(u.jsx)("div",{className:"group-description text-shadow",children:e.userInGroup?e.description:"not in this group"}),Object(u.jsx)("div",{className:"my-group",children:e.userInGroup?"":e.invitationRequested?"invitation was requested":"click to ask for an invitation"})]},e.id),Object(u.jsxs)("div",{className:"group-extra-data",children:[Object(u.jsxs)("div",{children:[e.playersCount," players"]}),Object(u.jsxs)("div",{children:[e.gamesCount," games"]})]})]},e.id)}));return Object(u.jsxs)("div",{id:"user-groups",className:"row",children:[r&&Object(u.jsx)("div",{className:"row",children:Object(u.jsx)("div",{className:"",children:Object(u.jsx)("div",{className:"group-item-div",onClick:this.props.createGroup,children:Object(u.jsx)("img",{src:"plus.png",className:"group-item-div-plus-sign"})})})}),n]})}},{key:"render",value:function(){var e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);return Object(u.jsx)("div",{id:"groups-page",children:Object(u.jsxs)(c.a,{defaultActiveKey:"myGroups",id:"uncontrolled-tab-example",style:{fontSize:e?"0.8em":"1em"},activeKey:this.state.tabKey,onSelect:this.onKeyChange,variant:"pills",children:[Object(u.jsx)(l.a,{eventKey:"myGroups",title:"My Groups",children:this.getUserGroupsDiv()}),Object(u.jsx)(l.a,{eventKey:"otherGroups",title:"Other Groups",children:this.getOtherGroupsDiv()})]})})}}]),a}(o.Component);t.a=m},412:function(e,t,a){"use strict";var r=a(4),n=a(16),s=a(19),i=a(18),o=a(17),c=a(1),l=(a(146),a(5)),u=a.n(l),d=a(7),m=a(14),p=a.n(m),h=a(15);function g(){return(g=Object(d.a)(u.a.mark((function e(t,a,r,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getGame "),e.abrupt("return",new Promise((function(e,s){var i={method:"GET",url:"".concat(h.a,"/groups/").concat(t,"/games/").concat(a),headers:{provider:r,"x-auth-token":n,"Content-Type":"application/json"}};p()(i,(function(t,a,r){if(t||a.statusCode>=400){if(t)return console.error("request cb error.failed to get game data",t),s("failed to get game data");var n=JSON.parse(r);return console.error("failed to get game data",n),s(n.title)}var i=JSON.parse(r);return e(i)}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var j=function(e,t,a,r){return g.apply(this,arguments)};function b(){return(b=Object(d.a)(u.a.mark((function e(t,a,r,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,s){var i={method:"POST",url:"".concat(h.a,"/groups/").concat(t,"/games"),body:JSON.stringify(a),headers:{provider:r,"x-auth-token":n,"Content-Type":"application/json"}};p()(i,(function(t,a,r){if(t||a.statusCode>=400){if(t)return console.error("request cb error",t),s("failed to create new game");var n=JSON.parse(r);return console.error("failed to create new game"),s(n.title)}return e(JSON.parse(r))}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var f=function(e,t,a,r){return b.apply(this,arguments)};function v(){return(v=Object(d.a)(u.a.mark((function e(t,a,r,n,s){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var o={method:"PATCH",url:"".concat(h.a,"/groups/").concat(t,"/games/").concat(a),body:JSON.stringify(r),headers:{provider:n,"x-auth-token":s,"Content-Type":"application/json"}};console.log("updateGame options",o),p()(o,(function(t,a,r){if(t||a.statusCode>=400){if(t)return console.error("request cb error",t),i("failed to update game");var n=JSON.parse(r);return console.error("failed to update game"),i(n.title)}return e(JSON.parse(r))}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=function(e,t,a,r,n){return v.apply(this,arguments)};function y(){return(y=Object(d.a)(u.a.mark((function e(t,a,r,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,s){var i={method:"DELETE",url:"".concat(h.a,"/groups/").concat(t,"/games/").concat(a),headers:{provider:r,"x-auth-token":n,"Content-Type":"application/json"}};p()(i,(function(t,a,r){if(t||a.statusCode>=400){if(t)return console.error("request cb error",t),s("failed to delete game");var n=JSON.parse(r);return console.error("failed to delete game"),s(n.title)}return e()}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=function(e,t,a,r){return y.apply(this,arguments)},w=a(416),G=a(81),I=a(105),S=a.n(I),N=a(107),C=a(56),k=a(46),P={ANON_URL:"anonymous2.png",GREEN:"green.png",RED:"red.png",TRANSPARENT:"transparent.png"},D=document.getElementsByTagName("body")[0],E=window.innerWidth||document.documentElement.clientWidth||D.clientWidth,T={Width:E,Height:window.innerHeight||document.documentElement.clientHeight||D.clientHeight,SmartPhone:E<600},A=a(91),U=a.n(A),M=a(2),B=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(n.a)(this,a),(r=t.call(this,e)).state={index:0};var s=e.group,i=e.gameId,o=e.playerId,c=s.images,l=s.games,u=s.players,d=c.filter((function(e){return i?e.gameIds.includes(i):!o||e.playerIds.includes(o)}));return r.items=d.map((function(e){var t=l.find((function(t){return e.gameIds.includes(t.id)})),a=t?t.date.AsGameName():"",r=u.filter((function(t){return e.playerIds.includes(t.id)})).map((function(e){return e.name})).join(",");return{original:e.image,thumbnail:e.image,date:a,sizes:"10vw",taggedPlayers:r}})),r.ref=setInterval((function(){var e=r.state.index+1;e>=d.length&&(e=0),r.setState({index:e})}),5e3),r}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.gameId,a=e.playerId;return 0===this.items.length?(console.log("no images found for this game/player"),Object(M.jsx)("div",{})):Object(M.jsxs)("div",{className:"image-slider",children:[a&&Object(M.jsx)("div",{children:"player images"}),t&&Object(M.jsx)("div",{children:"game images"}),Object(M.jsx)("img",{src:this.items[this.state.index].original}),Object(M.jsx)("div",{children:this.items[this.state.index].date}),Object(M.jsxs)("div",{children:["in the picture: ",this.items[this.state.index].taggedPlayers]})]})}}]),a}(c.Component),F=["#317F42","#14A9B6","#D9892B","#A23DA3","#A3A23D","#9189DF","#74B0A1","#A53542","#FD0724","#8F6947","#FF77E7","#447F66","#55A9A7","#D6696B","#423D7A"],R=P.ANON_URL,L=P.GREEN,J=P.RED,V=P.TRANSPARENT,_=T.Width,K=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),q=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(n.a)(this,a),(r=t.call(this,e)).createPlayersDataAsFakeGame=function(e,t,a,n,s){var i=e.games;r.balances={},r.totalGamesCounts={},r.gamesCount={};var o=s?n-12<0?0:n-12:a,c=i.sort((function(e,t){return e.date<t.date?-1:1}));return c.slice(o,n+1).forEach((function(e){e.playersData.forEach((function(t){var a=t.playerId;r.gamesCount.hasOwnProperty(a)||(r.gamesCount[a]=0),r.gamesCount[a]=r.gamesCount[a]+(s||e.mvpPlayerId===a?1:0)}))})),c.slice(a,n+1).forEach((function(e){e.playersData.forEach((function(t){var a=t.playerId,n=t.buyIn,i=t.cashOut;r.balances.hasOwnProperty(a)||(r.balances[a]=0),r.totalGamesCounts.hasOwnProperty(a)||(r.totalGamesCounts[a]=0),r.balances[a]=s?r.balances[a]+i-n:r.balances[a]+(a===e.mvpPlayerId?1:0),r.totalGamesCounts[a]=r.totalGamesCounts[a]+1}))})),r.playersCountText=Object.keys(r.balances).length,{playersData:Object.keys(r.gamesCount).map((function(e){return{id:e,playerId:e,buyIn:0,cashOut:r.balances[e],lastFourMonthGamesCount:r.gamesCount[e],gamesCount:r.totalGamesCounts[e],percentage:s?void 0:Math.floor(100*r.balances[e]/r.totalGamesCounts[e])}})).sort((function(e,t){return e.lastFourMonthGamesCount>t.lastFourMonthGamesCount?-1:e.lastFourMonthGamesCount<t.lastFourMonthGamesCount?1:e.gamesCount<t.gamesCount?-1:1})).slice(0,t+1).filter((function(e){return!!s||e.cashOut>0&&e.gamesCount>0}))}},r.prop=e;var s=e.group;r.yearsObject={},s.games.sort((function(e,t){return e.date<t.date?-1:1})).forEach((function(e,t){var a=e.date.getYear()+1900;r.yearsObject[a]?r.yearsObject[a].to=t:r.yearsObject[a]={from:t,to:t}}));var i={min:0,max:s.games.length-1},o=e.IsGroupSummary?r.createPlayersDataAsFakeGame(e.group,e.playersCount,i.min,i.max,!0):e.game;return r.state={sliderValues:i,Game:o,isPlaying:!1,showSummaryByMoney:!0,IsGroupSummary:e.IsGroupSummary},r}return Object(s.a)(a,[{key:"updateAfterSwitch",value:function(){var e=!this.state.showSummaryByMoney,t=this.createPlayersDataAsFakeGame(this.prop.group,this.prop.playersCount,this.state.sliderValues.min,this.state.sliderValues.max,e);this.setState({Game:t,showSummaryByMoney:e})}},{key:"getPlayerImage",value:function(e,t,a){var r=e.isMe,n="".concat(e.playerId,"_item_image"),s=t-a,i={width:s,height:1.1*s,marginRight:a};r&&(i.border="1px solid yellow");var o=e.name,c=e.imageUrl||R;return Object(M.jsx)("img",{alt:o,style:i,className:"GamePlayerImage",src:c,onError:function(t){t.target.secondTry?t.target.src=R:(t.target.secondTry=!0,t.target.src=e.imageUrl)}},n)}},{key:"getNamesSection",value:function(e,t,a,r){return e.map((function(e){var n="".concat(e.playerId,"_item_name"),s=e.name.trim(),i="GamePlayerDisplayName";if(s.indexOf(" ")>0){var o=r?0:1;s=s.split(" ")[o]}else r||(s="----",i+=" transparentTextColor");var c={width:t-a,marginRight:a};return Object(M.jsx)("div",{style:c,className:i,children:s},n)}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.group,n=t.IsGroupSummary,s=t.playersCount,i=this.state,o=i.Game,c=i.sliderValues,l=i.showSummaryByMoney;if(a.games.length-1<this.state.sliderValues.max){c.min=0,c.max=a.games.length-1;var u=Object(r.a)({},c);setTimeout((function(){e.setState({sliderValues:u})}),1)}var d=a.players,m=o.playersData;if(0===m.length)return Object(M.jsx)("div",{children:" no players yet"});var p=m.map((function(e){var t=Object(r.a)({},e),a=d.find((function(e){return e.id===t.playerId}));return t.dif=t.cashOut-t.buyIn,t.val=t.dif>0?"+".concat(t.dif):"".concat(t.dif),t.imageUrl=a.imageUrl,t.isMe=a.isMe,t.name=a.name,t.gamesCount=a.gamesCount,t})).sort((function(e,t){return e.dif>t.dif?-1:1})).filter((function(e){return e.gamesCount}));if(!p||0===p.length)return Object(M.jsx)("div",{children:"No data yet"});var h=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),g=h?2:5,j=p.filter((function(e){return e.dif<=0})).length>0,b=n?h?.8*_:.93*_:h?.8*_:.63*_,f=p.length<3?b/4:b/p.length,v=p.map((function(t){return e.getPlayerImage(t,f,g)})),O=this.getNamesSection(p,f,g,!0),y=this.getNamesSection(p,f,g,!1),x=l?"\u20aa":" out of",w=p.map((function(t){var a="".concat(t.playerId,"_item_balance"),r=n?e.balances[t.playerId]:t.val,s={width:f-g,marginRight:g};return Object(M.jsxs)("div",{style:s,className:"GamePlayerBalace",children:[Object(M.jsx)("span",{className:"GamePlayerBalaceCurrencySign",children:l?"":"mvp in "})," ",r,Object(M.jsx)("span",{className:"GamePlayerBalaceCurrencySign",children:x})]},a)})),G=n?p.map((function(t){var a="".concat(t.playerId,"_item_gamesCount"),r={width:f-g,marginRight:g};return Object(M.jsxs)("div",{style:r,className:"GamePlayerGamesCount",children:[e.totalGamesCounts[t.playerId]," games"]},a)})):[],I=n?p.map((function(e){var t="".concat(e.playerId,"_item_percentage"),a={width:f-g,marginRight:g};return Object(M.jsx)("div",{style:a,className:"GamePlayerGamesCount",children:Object(M.jsxs)("div",{className:"GamePlayersGamesCount",children:[" ","(".concat(e.percentage,"%)")," "]})},t)})):[],S=j?Object(M.jsx)("div",{}):p.map((function(e){var t="".concat(e.playerId,"_item_Rankingbalance"),a={width:f-g,marginRight:g};return Object(M.jsx)("div",{style:a,className:"GamePlayerBalace",children:e.val},t)})),N=p[0].dif,C=0===N?10:100/N,P=p.map((function(e){var t="".concat(e.playerId,"_item_positiveDiv"),a=e.dif>0?L:V,r=e.dif>0?C*e.dif:150,n={marginTop:150-r,width:f-g,marginRight:g,height:r};return Object(M.jsx)("img",{alt:"",className:"barItemPositive",style:n,src:a},t)})),D=p[p.length-1].dif,E=0===D?10:100/D,T=p.map((function(e){var t=e.dif<0?J:V,a="".concat(e.playerId,"_item_negativeDiv"),r=e.dif>0?150:E*e.dif,n={marginTop:-1*(150-r),width:f-g,marginRight:g,height:r};return Object(M.jsx)("img",{alt:"",className:"barItemNegative",style:n,src:t},a)}));P=Object(M.jsx)("div",{className:"GamePlayerBars",children:P}),T=j?Object(M.jsx)("div",{className:"GamePlayerBars",children:T}):Object(M.jsx)("div",{});var A={},R={},q=a.games.sort((function(e,t){return e.date<t.date?-1:1})).filter((function(e,t){return c.min<=t&&t<=c.max}));q.forEach((function(e){e.playersData.forEach((function(e){var t=e.playerId,a=e.buyIn,r=e.cashOut;A.hasOwnProperty(t)||(A[t]=0),R.hasOwnProperty(t)||(R[t]=0),A[t]+=1,R[t]=R[t]+r-a}))}));var W=Object.keys(A).map((function(e,t){var r=a.players.find((function(t){return t.id===e})).name;return{playerId:e,gamesCount:A[e],name:r,id:e,balance:R[e]}})).sort((function(e,t){return e.gamesCount<t.gamesCount?1:-1})).slice(0,s).map((function(e,t){return Object(r.a)(Object(r.a)({},e),{},{color:F[t]})})),H={},z=[],Y={name:""};W.forEach((function(e){H[e.playerId]=e.name,Y[e.name]=0})),z.push(Y),q.forEach((function(e){var t=z[z.length-1],a=e.playersData.filter((function(e){return H[e.playerId]})).map((function(e){return{name:H[e.playerId],dif:e.cashOut-e.buyIn}})),r={name:e.date.AsGameName()};a.forEach((function(e){var a=e.name,n=e.dif,s=t[a];r[a]=n+s})),W.forEach((function(e){if(!r.hasOwnProperty(e.name)){var a=t[e.name];r[e.name]=a}})),z.push(r)}));var Z=W.map((function(e){return Object(M.jsx)(k.b,{className:"graphLine",type:"monotone",dataKey:e.name,stroke:e.color},"line".concat(e.name))})),X=W.sort((function(e,t){return e.balance>t.balance?-1:1})).map((function(e){var t=e.id,a=e.name,r=e.color,n=e.balance,s={color:r};return Object(M.jsxs)("div",{className:"menuItem",style:s,children:[" ",a,": ",n," (",A[t]," games) "]},"menu".concat(r).concat(a))})),Q=Object.keys(this.yearsObject).sort().map((function(t){return Object(M.jsx)("button",{className:"year-button",onClick:function(){var a={isPlaying:!1,sliderValues:{min:e.yearsObject[t].from,max:e.yearsObject[t].to}};e.props.IsGroupSummary&&(a.Game=e.createPlayersDataAsFakeGame(e.props.group,e.props.playersCount,e.yearsObject[t].from,e.yearsObject[t].to,e.state.showSummaryByMoney)),e.setState(a)},children:t},"year-".concat(t))}));Q.push(Object(M.jsx)("button",{className:"year-button",onClick:function(){var t={isPlaying:!1,sliderValues:{min:0,max:a.games.length-1}};t.Game=e.createPlayersDataAsFakeGame(e.prop.group,e.prop.playersCount,t.sliderValues.min,t.sliderValues.max,e.state.showSummaryByMoney),e.setState(t)},children:"All"},"all-years"));var $=Object(M.jsx)("button",{className:"year-button",onClick:function(){var t={};if(e.state.isPlaying)t.isPlaying=!1;else{t.sliderValues={min:0,max:4},t.isPlaying=!0;setTimeout((function t(){var r={sliderValues:{min:0,max:e.state.sliderValues.max+1}};r.sliderValues.max>a.games.length-1&&(r.sliderValues.max=4),r.Game=e.createPlayersDataAsFakeGame(a,e.props.playersCount,0,e.state.sliderValues.max,e.state.showSummaryByMoney),e.state.isPlaying&&(e.setState(r),setTimeout(t,70))}),1500)}e.setState(t)},children:this.state.isPlaying?"Stop":"Play"},"play-all"),ee=Object(M.jsxs)("div",{children:[$,Object(M.jsxs)(k.c,{className:"gameGraphLineChart",width:K?_:.88*_,height:K?260:500,data:z,children:[Object(M.jsx)(k.e,{dataKey:"name"}),Object(M.jsx)(k.f,{}),Object(M.jsx)(k.a,{strokeDasharray:"0 40"}),Object(M.jsx)(k.d,{y:0,label:"Zero",stroke:"red"}),Z]}),Object(M.jsx)("div",{children:Q}),Object(M.jsx)("div",{className:"menu",children:X})]}),te=n?Object(M.jsxs)("div",{className:"black",children:[c.max-c.min+1," games (",a.games[c.min].date.AsGameName()," - ",a.games[c.max].date.AsGameName(),")"]}):Object(M.jsx)("div",{}),ae=n?this.playersCountText:m.length;return Object(M.jsxs)("div",{className:"allPlayersSummary ".concat(n?"groupSummary":""),children:[this.props.IsGroupSummary&&(c.min>0||c.max<this.props.group.games.length-1)&&Object(M.jsx)("div",{className:"black",children:Object(M.jsx)("b",{children:"(filtered data)"})}),te,Object(M.jsxs)("div",{className:"black",children:[ae," players"]}),Object(M.jsx)("div",{children:Object(M.jsx)("span",{className:"white",children:"xx"})}),Object(M.jsx)("div",{className:"GamePlayerNames",children:O}),Object(M.jsx)("div",{className:"GamePlayerNames",children:y}),Object(M.jsx)("div",{className:"GamePlayerImages",children:v}),Object(M.jsx)("div",{className:"GamePlayerBalance",children:w}),n?Object(M.jsxs)("div",{className:"GamePlayersGamesCount",children:[" ",G," "]}):Object(M.jsx)("div",{}),n&&!l?Object(M.jsxs)("div",{className:"GamePlayersGamesCount",children:[" ",I," "]}):Object(M.jsx)("div",{}),Object(M.jsx)("br",{}),Object(M.jsx)("br",{}),P,S,T,Object(M.jsx)("div",{children:this.state.IsGroupSummary?Object(M.jsxs)("button",{onClick:function(){return e.updateAfterSwitch()},children:[" ",this.state.showSummaryByMoney?"switch to games won mode":"switch back"]}):Object(M.jsx)("span",{})}),Object(M.jsx)("hr",{}),n&&a.games.length>0&&Object(M.jsxs)("div",{className:"black",children:[Object(M.jsxs)("div",{children:[Object(M.jsx)("b",{children:"Date range specific data:"}),Object(M.jsx)("br",{})]}),Object(M.jsxs)("div",{children:["From ",a.games[c.min].date.AsGameName()," to ",a.games[c.max].date.AsGameName()]}),Object(M.jsx)("div",{children:Object(M.jsx)(U.a,{className:"InputRange",step:1,formatLabel:function(){return""},maxValue:a.games.length-1,minValue:0,value:c,onChange:function(t){if(t.min<t.max){var r={sliderValues:t};n&&(r.Game=e.createPlayersDataAsFakeGame(a,e.props.playersCount,t.min,t.max,e.state.showSummaryByMoney)),e.setState(r)}}})}),Object(M.jsx)("div",{children:ee})]}),!n&&Object(M.jsx)(B,{group:a,gameId:o.id})]})}}]),a}(c.Component),W=a(31),H=a(407),z=a(408),Y=a.n(z);function Z(e,t){if(0===e.length||0===t.length)return[];if(1===e.length&&1===t.length){if(e[0].balance===t[0].balance)return[{from:t[0],to:e[0],amount:t[0].balance}];throw console.log("positivePlayers",e),console.log("negativePlayers",t),new Error("WTF, this does not make sense")}var a=Y.a.intersectionBy(t,e,"balance"),n=[];if(a&&a.length>0){var s,i=Object(H.a)(a);try{var o=function(){var a=s.value,r=t.find((function(e){return e.balance===a.balance})),i=e.find((function(e){return e.balance===a.balance}));r&&i&&(n.push({from:r,to:i,amount:i.balance}),t=t.filter((function(e){return e.id!==a.id})),e=e.filter((function(e){return e.id!==i.id})))};for(i.s();!(s=i.n()).done;)o()}catch(u){i.e(u)}finally{i.f()}}t=t.sort((function(e,t){return e.balance<t.balance?-1:1})),e=e.sort((function(e,t){return e.balance<t.balance?-1:1}));var c=t[0],l=e[0];return c.balance>l.balance?(n.push({from:c,to:l,amount:l.balance}),e=e.filter((function(e){return e.id!==l.id})),t=t.map((function(e){return e.id!==c.id?e:Object(r.a)(Object(r.a)({},e),{},{balance:c.balance-l.balance})}))):c.balance<l.balance&&(n.push({from:c,to:l,amount:c.balance}),t=t.filter((function(e){return e.id!==c.id})),e=e.map((function(e){return e.id!==l.id?e:Object(r.a)(Object(r.a)({},e),{},{balance:l.balance-c.balance})}))),[].concat(n,Object(W.a)(Z(e,t)))}function X(e,t){var a=e.playersData.map((function(e){var a=t.players.find((function(t){return t.id===e.playerId}));return{id:e.playerId,name:a.name,imageUrl:a.imageUrl,cashOut:e.cashOut,buyIn:e.buyIn,balance:e.cashOut-e.buyIn}})),n=a.filter((function(e){return e.balance>0})).sort((function(e,t){return e.balance<t.balance?-1:1})),s=a.filter((function(e){return e.balance<0})).map((function(e){return Object(r.a)(Object(r.a)({},e),{},{balance:-1*e.balance})})).sort((function(e,t){return e.balance<t.balance?-1:1}));return console.log("positivePlayers",n),console.log("negativePlayers",s),Z(n,s).sort((function(e,t){return e.from.id<t.from.id?-1:e.from.id>t.from.id?1:e.amount<t.amount?-1:1}))}var Q=function(e){console.log("WW props",e);var t=X(e.game,e.group);return Object(M.jsx)("div",{children:t.map((function(e){return Object(M.jsxs)("div",{className:"from-to-row",children:[" ",Object(M.jsxs)("b",{children:[" ",e.from.name," "]})," should give ",Object(M.jsxs)("b",{children:[" ",e.amount,"\u20aa "]})," to ",Object(M.jsxs)("b",{children:[" ",e.to.name," "]})," "]},"_from_".concat(e.from.id,"_to").concat(e.to.id))}))})},$=a(20),ee=a(53),te=P.ANON_URL,ae=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(n.a)(this,a),(r=t.call(this,e)).showWhoOwesWho=function(){r.setState({shouldShowWhoOwesWho:!r.state.shouldShowWhoOwesWho})},r.getGamePot=function(e){return e.playersData.reduce((function(e,t){return e+t.buyIn}),0)},r.gameDateToString=function(e){var t=function(e){var t="".concat(e);return 2===t.length?t:"0".concat(t)},a="string"===typeof e.date?e.date.substr(0,10):e.date.toISOString(),r=parseInt(a.substr(0,4),10),n=t(parseInt(a.substr(5,2),10)),s=t(parseInt(a.substr(8,2),10));return"".concat(s,"/").concat(n,"/").concat(r)},console.log("gamesummary ctor",e);var s=e.group,i=e.game,o=s.isAdmin;r.state={shouldShowWhoOwesWho:!1};var c=i.playersData.map((function(e){var t=s.players.find((function(t){return t.id===e.playerId}));return{id:e.playerId,name:t.name,imageUrl:t.imageUrl,cashOut:e.cashOut,buyIn:e.buyIn,balance:e.cashOut-e.buyIn}})).sort((function(e,t){return e.name<t.name?-1:1})).map((function(e,t){return Object(M.jsxs)("div",{className:"gamePlayerData col-xs-11 col-lg-2 row",children:[Object(M.jsx)("div",{className:"col-xs-3",children:Object(M.jsx)("img",{alt:e.name,className:"gamePlayerDataImage",src:e.imageUrl||te,onError:function(t){t.target.secondTry?t.target.src=te:(t.target.secondTry=!0,t.target.src=e.imageUrl)}})}),Object(M.jsxs)("div",{className:"col-xs-8",children:[Object(M.jsx)("div",{children:e.name}),Object(M.jsxs)("div",{children:["buy-in: ",e.buyIn]}),Object(M.jsxs)("div",{children:["cash-out: ",e.cashOut]}),Object(M.jsxs)("div",{children:["bottom-line: ",e.balance]})]})]},"gamePlayerData".concat(e.id))}));return r.game=i,r.gamePlayersData=c,r.isAdmin=o,r}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.group,t=this.game,a=this.gamePlayersData,r=this.isAdmin;return Object(M.jsxs)("div",{id:"gameSummary",children:[Object(M.jsxs)("div",{id:"gameSummaryHeader",children:[Object(M.jsx)($.a,{onClick:this.props.back,className:"button",children:"Back"}),Object(M.jsx)("div",{children:Object(M.jsx)("b",{children:Object(M.jsx)("u",{children:"Game summary"})})}),Object(M.jsxs)("div",{children:["Date: ",this.gameDateToString(t)]}),Object(M.jsx)("div",{children:t.description}),Object(M.jsxs)("div",{children:["Pot size:  ",this.getGamePot(t)]})]}),Object(M.jsx)(q,{group:e,game:t}),r&&Object(M.jsx)($.a,{onClick:this.props.edit,className:"button left-margin",children:"Edit"}),r&&Object(M.jsx)(ee.a,{onClick:this.props.delete,className:"button left-margin",children:"Delete"}),Object(M.jsxs)($.a,{onClick:this.showWhoOwesWho,className:"button left-margin",children:[" ",this.state.shouldShowWhoOwesWho?"Hide":"Show"," Who Owes Who"]}),this.state.shouldShowWhoOwesWho&&Object(M.jsx)(Q,{group:e,game:t}),Object(M.jsx)("div",{className:"more-data-text",children:Object(M.jsx)("u",{children:"more data:"})}),Object(M.jsx)("div",{id:"gamePlayersData",className:"row",children:a})]})}}]),a}(c.Component);function re(){return(re=Object(d.a)(u.a.mark((function e(t,a,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var s={method:"DELETE",url:"".concat(h.a,"/images/").concat(t),headers:{provider:a,"x-auth-token":r,"Content-Type":"application/json"}};p()(s,(function(t,a,r){if(t||a.statusCode>=400){if(t)return console.error("request cb error",t),n("failed to delete image");var s=JSON.parse(r);return console.error("failed to delete image"),n(s.title)}return e(!0)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ne=function(e,t,a){return re.apply(this,arguments)},se=a(65),ie=a(79),oe=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).removeImage=function(){if(confirm("Are you sure?")){var e=r.props,t=e.id,a=e.close,n=e.provider,s=e.token,i=e.removeImage;ne(t,n,s).then((function(){r.setState({showSuccessDeleteImage:!0}),setTimeout((function(){r.setState({showSuccessDeleteImage:null}),i(t),a()}),100)})).catch((function(e){r.setState({showErrorOnDeleteImage:!0}),setTimeout((function(){r.setState({showErrorOnDeleteImage:null}),a()}),100)}))}},r.state={showErrorOnDeleteImage:null,showSuccessDeleteImage:null},r}return Object(s.a)(a,[{key:"render",value:function(){var e=this.state,t=e.showErrorOnDeleteImage,a=e.showSuccessDeleteImage,r=this.props,n=r.image,s=r.group,i=r.uploadedByName,o=r.uploadedById,c=r.playerIds,l=r.gameIds,u=r.user,d=u.id,m=!1;s&&u&&u.groups&&u.groups[s.id]&&(m=u.groups[s.id].isAdmin);var p=m||d===o;console.log("user",u);var h=s.games.find((function(e){return e.id===l[0]})),g=h?h.date.AsGameName():"unknown",j=s.players.filter((function(e){return c.includes(e.id)}));return j=j.map((function(e){return Object(M.jsxs)("li",{children:[" ",e.name]},"taged_players_".concat(e.id))})),Object(M.jsxs)("div",{id:"image-data",children:[Object(M.jsxs)("div",{className:"image-data-item",children:[Object(M.jsx)("div",{children:Object(M.jsx)("img",{alt:"image",id:"image-data-preview",src:n})}),Object(M.jsxs)("div",{children:["Uploaded by: ",i]}),Object(M.jsx)("hr",{}),Object(M.jsxs)("div",{children:[Object(M.jsx)("b",{children:Object(M.jsx)("u",{children:"Tags:"})}),Object(M.jsxs)("div",{children:["Group: ",s.name]}),Object(M.jsxs)("div",{children:["Game: ",g]}),Object(M.jsx)("div",{children:"Players:"}),Object(M.jsx)("div",{children:Object(M.jsxs)("ul",{children:[" ",j," "]})}),Object(M.jsx)("div",{children:Object(M.jsx)($.a,{className:"close-button",onClick:this.props.close,children:"back"})}),Object(M.jsx)("div",{children:Object(M.jsx)(ee.a,{disabled:!p,className:"delete-image-button",onClick:this.removeImage,children:"DELETE IMAGE"})})]})]}),t&&Object(M.jsx)(se.a,{message:"failed to remove image"}),a&&Object(M.jsx)(ie.a,{message:"image was removed"})]})}}]),a}(c.Component),ce=a(106),le=a(409),ue=a.n(le);function de(){return(de=Object(d.a)(u.a.mark((function e(t,a,r,n,s){var i,o,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{console.log("before",t),t=ue()(t,600,600),console.log("after",t)}catch(l){console.log("error!!",l)}return i=a.playerIds,o=a.gameIds,c=a.groupIds,e.abrupt("return",new Promise((function(e,a){var l={method:"POST",url:"".concat(h.a,"/images"),body:JSON.stringify({playerIds:i||[],gameIds:o||[],groupIds:c||[],image:t,playerImage:r}),headers:{provider:n,"x-auth-token":s,"Content-Type":"application/json"}};p()(l,(function(t,r,n){if(t||r.statusCode>=400){if(t)return console.error("request cb error",t),a("failed to post image");var s=JSON.parse(n);return console.error("failed to post image"),a(s.title)}return e(JSON.parse(n))}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var me=function(e,t,a,r,n){return de.apply(this,arguments)},pe=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).showImageUploaderForm=function(){r.setState({showImageUploader:!0})},r.hideImageUploaderForm=function(){r.setState({showImageUploader:!1})},r.enterImagePage=function(e){r.setState({selectedImage:e})},r.closeImagePage=function(){r.setState({selectedImage:null})},r.uploadImage=function(){var e=Object(d.a)(u.a.mark((function e(t,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",me(t,a,!1,r.props.provider,r.props.token));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),r.state={selectedImage:null,showImageUploader:!1},r}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.group;if(this.state.selectedImage)return Object(M.jsx)(oe,Object(r.a)(Object(r.a)({group:t,close:this.closeImagePage,user:this.props.user},this.state.selectedImage),{},{provider:this.props.provider,removeImage:this.props.removeImage,token:this.props.token}));if(this.state.showImageUploader)return Object(M.jsx)(ce.a,{group:t,close:this.hideImageUploaderForm,uploadImage:this.uploadImage,updateImage:this.props.updateImage});var a=t.images.map((function(t){return Object(M.jsx)("div",{className:"image-item-div",onClick:function(){e.enterImagePage(t)},children:Object(M.jsx)("img",{className:"image-item-div-innerimg",alt:"uploaded by ".concat(t.uploadedByName),src:t.image},"".concat(t.id,"__"))},"".concat(t.id))}));return Object(M.jsxs)("div",{className:"row",children:[Object(M.jsx)("div",{className:"col-xs-6",children:Object(M.jsx)("div",{className:"image-item-div",onClick:this.showImageUploaderForm,children:Object(M.jsx)("img",{src:"plus.png",className:"image-item-div-plus-sign"},"plus")})}),a]})}}]),a}(c.Component),he=P.ANON_URL,ge=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).createPlayerRow=function(t){var a=e.props,r=a.game,n=a.group.players,s=r.playersData.length,i=t.buyIn,o=t.cashOut,c=t.playerId,l=n.find((function(e){return e.id===c})),u=l.name,d=l.imageUrl,m=void 0===d?"":d,p=parseInt(o,10)-parseInt(i,10),h="".concat(i>0?"+":"").concat(i,"\u20aa"),g="".concat(o>0?"+":"").concat(o,"\u20aa"),j="".concat(p>0?"+":"").concat(p,"\u20aa"),b=60/s-.5,f={height:"".concat(b=b>16?15:b,"vh")};return Object(M.jsxs)("div",{className:"col-xs-12 activeGamePlayerRow",children:[Object(M.jsx)("div",{className:"col-xs-2 col-md-1",children:Object(M.jsx)("img",{alt:u,className:"activeGameImage",style:f,src:m||he,onError:function(e){m&&m.length>1&&!e.target.secondTry?(e.target.secondTry=!0,e.target.src=m):e.target.src=he}})}),Object(M.jsx)("div",{className:"col-xs-4 col-md-5 centeredText",children:u}),Object(M.jsxs)("div",{className:"col-xs-2",children:[" ",h]}),Object(M.jsxs)("div",{className:"col-xs-2",children:[" ",g]}),Object(M.jsxs)("div",{className:"col-xs-2 ".concat(p>0?"balanceWithCurrencyPositive":"balanceWithCurrencyNegative"),children:[" ",j]})]})},e.getPlayersDataAsList=function(){var t=e.props,a=t.game,n=t.group.players,s=a.playersData.map((function(e){var t=n.find((function(t){return t.id===e.playerId})),a=t.name,s=t.imageUrl;return Object(r.a)(Object(r.a)({},e),{},{name:a,imageUrl:s})})).sort((function(e,t){return e.index<t.index?-1:1})).map((function(e,t){var a=Object(M.jsx)("img",{alt:e.name,className:"activeGameCircleImage",src:e.imageUrl||he,onError:function(t){e.imageUrl&&e.imageUrl.length>1&&!t.target.secondTry?(t.target.secondTry=!0,t.target.src=e.imageUrl):t.target.src=he}}),r=e.cashOut-e.buyIn>0,n="".concat(r?"+":"").concat(e.cashOut-e.buyIn,"\u20aa"),s=e.extra?[].concat(Object(W.a)((e.extra.buyIns||[]).map((function(e){return{time:e.time,text:"".concat(e.time.AsExactTime(2)," +").concat(e.amount,"\u20aa buy in")}}))),Object(W.a)((e.extra.cashOuts||[]).map((function(e){return{time:e.time,text:"".concat(e.time.AsExactTime(2)," +").concat(e.amount,"\u20aa cash out")}})))).sort((function(e,t){return e.time<t.time?-1:1})):[];return Object(M.jsxs)("div",{className:"mobile-player",children:[a,Object(M.jsxs)("span",{className:"margin-both-sides",children:[e.name,":"]}),s.map((function(t){return Object(M.jsxs)("div",{className:"gray",children:[t.text,"  "]},"".concat(e.name,"-").concat(t.time,"-").concat(t.text))})),"bottom line:  ",n]},"player".concat(t))})),i=a.playersData.map((function(e){var t=n.find((function(t){return t.id===e.playerId})),a=t.name,s=t.imageUrl;return Object(r.a)(Object(r.a)({},e),{},{name:a,imageUrl:s})})).map((function(e){var t=Object(M.jsx)("img",{alt:e.name,className:"activeGameCircleImage",src:e.imageUrl||he,onError:function(t){e.imageUrl&&e.imageUrl.length>1&&!t.target.secondTry?(t.target.secondTry=!0,t.target.src=e.imageUrl):t.target.src=he}});return e.extra?[].concat(Object(W.a)((e.extra.buyIns||[]).map((function(a){return{time:a.time,image:t,timeText:a.time.AsExactTime(2),text:"".concat(e.name," added +").concat(a.amount,"\u20aa")}}))),Object(W.a)((e.extra.cashOuts||[]).map((function(a){return{time:a.time,image:t,timeText:a.time.AsExactTime(2),text:"".concat(e.name," took ").concat(a.amount,"\u20aa")}})))):[]}));return i=i.reduce((function(e,t){return[].concat(Object(W.a)(e),Object(W.a)(t))}),[]).sort((function(e,t){return e.time<t.time?-1:1})).map((function(e,t){return Object(M.jsxs)("div",{className:"inout-border",children:[e.timeText," ",e.image," ",e.text]},"".concat(t,"-itemm"))})),Object(M.jsxs)("div",{className:"mobile-players",children:[s,Object(M.jsx)("hr",{}),i]})},e.getAsPokerTable=function(){var t=e.props,a=t.game,n=t.group.players,s=a.playersData.map((function(e){var t=e.buyIn,a=Math.floor(t/50),s=a>0;t-=50*a;var i=Math.floor(t/25),o=i>0;t-=25*i;var c=Math.floor(t/10),l=c>0;t-=10*c;var u=Math.floor(t/5),d=u>0,m=t-=5*u,p=m>0,h=n.find((function(t){return t.id===e.playerId})),g=h.name,j=h.imageUrl;return Object(r.a)(Object(r.a)({},e),{},{hasBlue:s,bluesCount:a,hasGreen:o,greensCount:i,hasBlack:l,blacksCount:c,hasRed:d,redsCount:u,hasGrey:p,greysCount:m,name:g,imageUrl:j})})).sort((function(e,t){return e.name>t.name?-1:1})).map((function(e,t){var a=Object(M.jsx)("img",{alt:e.name,className:"activeGameCircleImage",src:e.imageUrl||he,onError:function(t){e.imageUrl&&e.imageUrl.length>1&&!t.target.secondTry?(t.target.secondTry=!0,t.target.src=e.imageUrl):t.target.src=he}}),r=e.cashOut-e.buyIn>0,n=e.cashOut?"".concat(r?"+":"").concat(e.cashOut-e.buyIn,"\u20aa"):"";return Object(M.jsx)("div",{children:Object(M.jsxs)("div",{className:"player player-".concat(t+1),children:[Object(M.jsx)("div",{className:"balance-value",children:n}),Object(M.jsxs)("div",{className:"bank",children:[Object(M.jsx)("div",{className:"bank-value",children:e.buyIn}),e.hasBlue?Object(M.jsxs)("div",{className:"jetons v-50",children:["x",e.bluesCount]}):Object(M.jsx)("div",{}),e.hasGreen?Object(M.jsxs)("div",{className:"jetons v-25",children:["x",e.greensCount]}):Object(M.jsx)("div",{}),e.hasBlack?Object(M.jsxs)("div",{className:"jetons v-10",children:["x",e.blacksCount]}):Object(M.jsx)("div",{}),e.hasRed?Object(M.jsxs)("div",{className:"jetons v-5",children:["x",e.redsCount]}):Object(M.jsx)("div",{}),e.hasGrey?Object(M.jsxs)("div",{className:"jetons v-1",children:["x",e.greysCount]}):Object(M.jsx)("div",{})]}),Object(M.jsx)("div",{className:"avatar",children:a}),Object(M.jsx)("div",{className:"name",children:e.name.split(" ")[0]})]})},"player".concat(t))}));return Object(M.jsx)("div",{className:"vue-container",children:Object(M.jsx)("div",{className:"table",children:Object(M.jsx)("div",{className:"players",children:s})})})},e.onEditClicked=function(){e.props.onGameEditClick()},e.onBackClicked=function(){e.interval&&(clearInterval(e.interval),e.interval=null),e.props.onBack()},e.render=function(){var t=e.props,a=t.onBack,r=t.game,n=t.group.isAdmin;if(!r)return Object(M.jsxs)("div",{children:["no game",Object(M.jsx)("div",{className:"backButton",children:Object(M.jsx)($.a,{className:"button",onClick:a,children:" Back"})})]});var s=r.playersData.map((function(e){return e.cashOut})).reduce((function(e,t){return e+t}),0),i=r.playersData.map((function(e){return e.buyIn})).reduce((function(e,t){return e+t}),0),o=e.getAsPokerTable(),c=e.getPlayersDataAsList(),l=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);return l||e.interval||(e.interval=setInterval(e.props.updateOnProgressGame,5e3),setTimeout((function(){console.log("going to show the game now.."),document.getElementById("ongoingGameTopBuffer").scrollIntoView()}),1e3)),Object(M.jsxs)("div",{className:"viewGamePopupInner",children:[Object(M.jsx)("div",{id:"ongoingGameTopBuffer",children:" "}),Object(M.jsxs)("div",{children:[Object(M.jsxs)("h3",{children:["Ongoing game..  ",("string"===typeof r.date?new Date(r.date):r.date).AsGameName()]}),Object(M.jsxs)("h4",{children:[r.playersData.length," Players. ",r.description," "]}),Object(M.jsx)("br",{}),Object(M.jsxs)("div",{className:"backButton",children:[Object(M.jsx)($.a,{className:"button ",onClick:e.onBackClicked,children:" Back"}),Object(M.jsx)($.a,{className:"button left-margin",onClick:e.onEditClicked,children:" Edit"}),n&&Object(M.jsx)(ee.a,{onClick:e.props.deleteSelectedGame,className:"button left-margin",children:"Delete"}),l?Object(M.jsxs)("div",{className:"potInTheMiddle",children:[i-s,"\u20aa In Pot"]}):Object(M.jsx)("div",{})]}),Object(M.jsx)("div",{className:"backButton",children:l?Object(M.jsx)("div",{}):Object(M.jsx)($.a,{className:"button",onClick:function(){document.getElementById("ongoingGameTopBuffer").scrollIntoView()},children:" Focus On Table"})})]}),l?c:o,l?Object(M.jsx)("div",{}):Object(M.jsxs)("div",{className:"potInTheMiddle",children:[i-s,"\u20aa In Pot"]})]})},e}return a}(c.Component),je=a(33),be=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).handleNewGameDateChange=function(e){var t=Object(r.a)(Object(r.a)({},s.state.newGame),{},{date:e.target.value});s.setState({newGame:t})},s.handleNewGameDescriptionChange=function(e){var t=Object(r.a)(Object(r.a)({},s.state.newGame),{},{description:e.target.value});s.setState({newGame:t})},s.createNewGame=function(){var e=s.props,t=e.group,a=e.provider,r=e.token,n=e.remoteCreateGame,i=e.updateGroupGame,o={date:"".concat(s.state.newGame.date,"T20:00:00.000Z"),description:s.state.newGame.description,playersData:[]};n(t.id,o,a,r).then((function(e){i(e),console.log("create game was ok"),s.setState({showSuccess:!0}),setTimeout((function(){s.setState({showSuccess:null}),s.props.close()}),10)})).catch((function(e){console.log("create game was NOT ok",e),s.setState({showError:!0}),setTimeout((function(){s.setState({showError:null}),s.props.close()}),10)}))},s.state={newGame:e.newGame,showError:null,showSuccess:null},s}return Object(s.a)(a,[{key:"render",value:function(){var e=this.state,t=e.showError,a=e.showSuccess,r=this.state.newGame.date&&10===this.state.newGame.date.length;return Object(M.jsxs)("div",{id:"new-game-form",children:[Object(M.jsx)("h2",{children:" Create a new game. "}),Object(M.jsxs)("div",{className:"new-game-section",children:["Game date:",Object(M.jsx)("input",{className:"left-margin",type:"date",id:"newGameDate",min:"2010-01-01",max:"2050-01-01",value:this.state.newGame.date,onChange:this.handleNewGameDateChange})]}),Object(M.jsxs)("div",{className:"new-game-section",children:["description:",Object(M.jsx)("input",{type:"text",id:"newGameExtra",className:"bordered-input left-margin left-pad",value:this.state.newGame.description,onChange:this.handleNewGameDescriptionChange})]}),Object(M.jsxs)("div",{className:"new-game-section",children:[Object(M.jsx)($.a,{className:"left-margin",onClick:this.props.close,children:" Cancel "}),Object(M.jsx)(je.a,{className:"left-margin",onClick:this.createNewGame,disabled:!r,children:" Create "})]}),t&&Object(M.jsx)(se.a,{message:"failed to create new game"}),a&&Object(M.jsx)(ie.a,{message:"game created successfully"})]})}}]),a}(c.Component),fe=P.ANON_URL,ve=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var s;Object(n.a)(this,a),(s=t.call(this,e)).updateSelectedGamePlayerData=function(){var e=Object(r.a)({},s.state.editGame),t=s.state.editPlayerInGame,a=t.playerId,n=t.cashOut,i=t.buyIn;e.playersData=e.playersData.map((function(e){return e.playerId!==a?e:Object(r.a)(Object(r.a)({},e),{},{cashOut:n,buyIn:i})})),console.log("updateSelectedGamePlayerData",e),s.setState({editGame:e,editPlayerInGame:null})},s.getEditPlayerInGame=function(){var e=s.state.editGame,t=s.state.editPlayerInGame,a=t.playerId,n=t.buyIn,i=s.props.group.players.find((function(e){return e.id===a})),o=Object(M.jsx)("img",{alt:i.name,className:"playersListImageBig",src:i.imageUrl||fe,onError:function(e){e.target.secondTry?e.target.src=fe:(e.target.secondTry=!0,e.target.src=i.imageUrl)}}),c=n+100,l=e.playersData.map((function(e){return e.buyIn})).reduce((function(e,t){return e+t}),0);return Object(M.jsxs)("div",{className:"edit-player-in-game",children:[Object(M.jsx)("div",{children:Object(M.jsxs)("h1",{children:[o,i.name]})}),Object(M.jsx)("hr",{}),Object(M.jsxs)("div",{children:["buy-in:   ",Object(M.jsx)("input",{className:"editPlayerInput",type:"number",id:"buyIn",value:s.state.editPlayerInGame.buyIn,onChange:function(e){var t=Object(r.a)({},s.state.editPlayerInGame);t.buyIn=parseInt(e.target.value,10),s.setState({editPlayerInGame:t})}}),Object(M.jsx)($.a,{className:"button left-margin",onClick:function(){var e=Object(r.a)({},s.state.editPlayerInGame);e.buyIn-=10,e.buyIn<0&&(e.buyIn=0),s.setState({editPlayerInGame:e})},children:" -10 "}),Object(M.jsx)($.a,{className:"button left-margin",onClick:function(){var e=Object(r.a)({},s.state.editPlayerInGame);e.buyIn+=10,s.setState({editPlayerInGame:e})},children:" +10 "}),Object(M.jsx)("br",{}),Object(M.jsx)("br",{}),Object(M.jsx)(U.a,{className:"InputRange",step:10,formatLabel:function(e){return"".concat(e,"\u20aa")},maxValue:c,minValue:0,value:s.state.editPlayerInGame.buyIn,onChange:function(e){var t=Object(r.a)({},s.state.editPlayerInGame);t.buyIn=e,s.setState({editPlayerInGame:t})}}),Object(M.jsx)("br",{}),Object(M.jsx)("br",{}),"  ",Object(M.jsx)("br",{}),Object(M.jsx)("br",{})]}),Object(M.jsxs)("div",{children:["cash-out:  ",Object(M.jsx)("input",{className:"editPlayerInput",type:"number",id:"cashOut",value:s.state.editPlayerInGame.cashOut,onChange:function(e){var t=Object(r.a)({},s.state.editPlayerInGame);t.cashOut=parseInt(e.target.value,10),s.setState({editPlayerInGame:t})}}),Object(M.jsx)($.a,{className:"button left-margin",onClick:function(){var e=Object(r.a)({},s.state.editPlayerInGame);e.cashOut-=10,e.cashOut<0&&(e.cashOut=0),s.setState({editPlayerInGame:e})},children:" -10 "}),Object(M.jsx)($.a,{className:"button left-margin",onClick:function(){var e=Object(r.a)({},s.state.editPlayerInGame);e.cashOut+=10,s.setState({editPlayerInGame:e})},children:" +10 "}),Object(M.jsx)("br",{}),Object(M.jsx)("br",{}),Object(M.jsx)(U.a,{className:"InputRange",step:10,formatLabel:function(e){return"".concat(e,"\u20aa")},maxValue:l,minValue:0,value:s.state.editPlayerInGame.cashOut,onChange:function(e){var t=Object(r.a)({},s.state.editPlayerInGame);t.cashOut=e,s.setState({editPlayerInGame:t})}})]}),Object(M.jsxs)("div",{children:[Object(M.jsx)("br",{})," ",Object(M.jsx)("br",{}),"balance: ",s.state.editPlayerInGame.cashOut-s.state.editPlayerInGame.buyIn]}),Object(M.jsxs)("div",{children:[Object(M.jsx)($.a,{className:"button",onClick:function(){return s.setState({editPlayerInGame:null})},children:" Cancel"}),Object(M.jsx)(je.a,{className:"button left-margin",onClick:s.updateSelectedGamePlayerData,children:" Save Player"}),Object(M.jsx)(je.a,{className:"button left-margin",onClick:function(){s.updateSelectedGamePlayerData(),setTimeout((function(){s.updateSelectedGame()}),500)},children:" Save Game"})]})]})},s.showImageUploaderForm=function(e){var t=e.gameId;s.setState({imageUploaderData:{gameId:t}})},s.hideImageUploaderForm=function(){s.setState({imageUploaderData:null})},s.findPlayerNotInGame=function(e){var t=s.props.group,a={},r={};t.players.forEach((function(e){a[e.id]=e})),e.playersData.forEach((function(e){r[e.playerId]=e}));var n=t.players.find((function(e){return!r[e.id]}));return n?n.id:null},s.showImageUploaderForm=function(e){var t=e.gameId;s.setState({imageUploaderData:{gameId:t}})},s.handleNewPlayerChange=function(e){s.setState({existingPlayerId:e})},s.addCurrentPlayerToGame=function(){if(s.state.existingPlayerId){var e=s.props.group,t=Object(r.a)({},s.state.editGame);t.playersData.push({buyIn:50,cashOut:0,gameId:t.id,groupId:e.id,playerId:s.state.existingPlayerId,index:t.playersData.length}),console.log("editGame",t);var a=s.findPlayerNotInGame(t);console.log("new existingPlayerId",a),s.setState({existingPlayerId:a,editGame:t})}else console.log("no existingPlayerId")},s.updateSelectedGame=function(){var e=s.props,t=e.group,a=e.provider,r=e.token,n=e.remoteUpdateGame,i=e.updateGroupGame,o={id:s.state.editGame.id,date:"".concat(s.state.editGame.date,"T20:00:00.000Z"),description:s.state.editGame.description,playersData:s.state.editGame.playersData};console.log("calling update game with body:",o),n(t.id,o.id,o,a,r).then((function(e){i(e),console.log("updated game was ok",e),s.setState({showSuccess:!0,editGame:e}),setTimeout((function(){s.setState({showSuccess:null}),s.props.close()}),10)})).catch((function(e){console.log("update game was NOT ok",e),s.setState({showError:!0}),setTimeout((function(){s.setState({showError:null}),s.props.close()}),10)}))},s.getGamePot=function(e){return e.playersData.reduce((function(e,t){return e+t.buyIn}),0)},s.uploadImage=function(){var e=Object(d.a)(u.a.mark((function e(t,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",me(t,a,!1,s.props.provider,s.props.token));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),s.handleEditGameDateChange=function(e){var t=Object(r.a)(Object(r.a)({},s.state.editGame),{},{date:e.target.value});s.setState({editGame:t})},s.handleEditGameDescriptionChange=function(e){var t=Object(r.a)(Object(r.a)({},s.state.editGame),{},{description:e.target.value});s.setState({editGame:t})},s.getGameDiff=function(e){return e.playersData.map((function(e){return e.buyIn})).reduce((function(e,t){return e+t}),0)-e.playersData.map((function(e){return e.cashOut})).reduce((function(e,t){return e+t}),0)},s.removePlayerFromGame=function(e){var t=s.state.editGame;t.playersData=t.playersData.filter((function(t){return t.playerId!==e}));var a=s.findPlayerNotInGame(t);s.setState({editGame:t,existingPlayerId:a})},s.editGamePlayer=function(e){var t=s.state.editGame.playersData.find((function(t){return t.playerId===e})),a={playerId:e,buyIn:t.buyIn,cashOut:t.cashOut};s.setState({editPlayerInGame:a})};var i=s.findPlayerNotInGame(e.editGame);return s.state={editGame:e.editGame,existingPlayerId:i,gameSummary:null,editPlayerInGame:null,imageUploaderData:null,showError:null,showSuccess:null},s}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.group;if(this.state.editPlayerInGame)return this.getEditPlayerInGame();if(this.state.imageUploaderData)return Object(M.jsx)(ce.a,Object(r.a)(Object(r.a)({group:t},this.state.imageUploaderData),{},{close:this.hideImageUploaderForm,uploadImage:this.uploadImage,updateImage:this.props.updateImage}));var a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),n={},s={};t.players.forEach((function(e){n[e.id]=e}));var i=this.state.editGame;if(!i)return console.log("render, no editGame on state"),Object(M.jsx)("div",{});i.playersData.forEach((function(e){s[e.playerId]=e}));var o=i.playersData.map((function(t){var r=n[t.playerId].name,s=n[t.playerId].imageUrl,i=Object(M.jsx)("img",{alt:r,className:"playersListImage",src:s||fe,onError:function(e){e.target.secondTry?e.target.src=fe:(e.target.secondTry=!0,e.target.src=s)}});return Object(M.jsxs)("div",{className:"editGamePlayerSection",children:[Object(M.jsx)(je.a,{className:"button edit-player-in-game-form",onClick:function(){return e.editGamePlayer(t.playerId)},children:" edit "}),i,a&&Object(M.jsx)("br",{}),r,Object(M.jsx)("span",{className:"gray-seprator",children:" |"}),a&&Object(M.jsx)("br",{}),"buy-in: ",t.buyIn," ",Object(M.jsx)("span",{className:"gray-seprator",children:" |"}),a&&Object(M.jsx)("br",{}),"cash-out: ",t.cashOut," ",Object(M.jsx)("span",{className:"gray-seprator",children:" |"}),a&&Object(M.jsx)("br",{}),"balance: ",t.cashOut-t.buyIn,Object(M.jsx)($.a,{className:"button remove-player-from-game",onClick:function(){return e.removePlayerFromGame(t.playerId)},children:" remove "})]},"_playerData_".concat(t.playerId))})),c=t.players.filter((function(e){return!s[e.id]})).map((function(e){return Object(M.jsx)("option",{value:e.id,children:e.name},"_comboVals_".concat(e.id))})),l=i.ready,u=this.getGameDiff(i),d=this.state,m=d.showError,p=d.showSuccess;return Object(M.jsxs)("div",{className:"game-edit-div",children:[Object(M.jsx)("h2",{children:" edit game. "}),Object(M.jsxs)("div",{className:"new-game-section",children:["Game date:",Object(M.jsx)("input",{className:"left-margin",type:"date",id:"newGameDate",min:"2010-01-01",max:"2050-01-01",value:this.state.editGame.date,onChange:this.handleEditGameDateChange})]}),Object(M.jsxs)("div",{className:"new-game-section",children:["description:",Object(M.jsx)("input",{type:"text",id:"newGameExtra",className:"bordered-input left-margin left-pad",value:this.state.editGame.description,onChange:this.handleEditGameDescriptionChange})]}),Object(M.jsxs)("div",{children:[Object(M.jsx)("div",{children:Object(M.jsxs)("u",{children:[o.length," Players:"]})}),Object(M.jsx)("div",{children:o})]}),Object(M.jsx)("hr",{}),c.length>0?Object(M.jsxs)("div",{children:[Object(M.jsx)("select",{name:"player",value:this.state.existingPlayerId,onChange:function(t){return e.handleNewPlayerChange(t.target.value)},children:c}),Object(M.jsx)(je.a,{className:"button left-margin",onClick:this.addCurrentPlayerToGame,children:" Add player"})]}):Object(M.jsx)("div",{children:"no more players"}),Object(M.jsx)("hr",{}),Object(M.jsxs)("div",{children:[Object(M.jsx)($.a,{className:"button left-margin",onClick:this.props.close,children:" Cancel"}),Object(M.jsx)(je.a,{className:"button left-margin",onClick:this.updateSelectedGame,children:" Save"})]}),Object(M.jsxs)("div",{children:[Object(M.jsx)("br",{}),Object(M.jsx)("h3",{children:l?"":"game still not done (".concat(u>0?u:-1*u," ").concat(u>0?"still in pot":"missing from pot",").")})]}),Object(M.jsx)(je.a,{onClick:function(){return e.showImageUploaderForm({gameId:i.id})},children:"upload image for this game"}),m&&Object(M.jsx)(se.a,{message:"failed to update game"}),p&&Object(M.jsx)(ie.a,{message:"game updated successfully"})]})}}]),a}(c.Component),Oe=a(66),ye=function(e){var t=Object(Oe.d)(),a=e.message;return setTimeout((function(){t.show(a)}),1),Object(M.jsx)("div",{})},xe=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),we=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).getImage=function(){return s.imageIndex++,s.imageIndex>s.imagesCount&&(s.imageIndex=1),"backgroundImage".concat(s.imageIndex,".jpg")},s.gameDateToString=function(e){var t=function(e){var t="".concat(e);return 2===t.length?t:"0".concat(t)},a="string"===typeof e.date?e.date.substr(0,10):e.date.toISOString(),r=parseInt(a.substr(0,4),10),n=t(parseInt(a.substr(5,2),10)),s=t(parseInt(a.substr(8,2),10));return"".concat(s,"/").concat(n,"/").concat(r)},s.clearAll=function(){s.setState({newGame:null,editGame:null,gameSummary:null})},s.showCreateGame=function(){var e=(new Date).toISOString().substring(0,10);s.setState({newGame:{date:e,description:"Hosted by .."}})},s.closeCreateGameForm=function(){s.setState({newGame:null})},s.closeEditGameForm=function(){s.setState({editGame:null})},s.handleEditGameDateChange=function(e){var t=Object(r.a)(Object(r.a)({},s.state.editGame),{},{date:e.target.value});s.setState({editGame:t})},s.handleEditGameDescriptionChange=function(e){var t=Object(r.a)(Object(r.a)({},s.state.editGame),{},{description:e.target.value});s.setState({editGame:t})},s.handleNewPlayerChange=function(e){s.setState({existingPlayerId:e})},s.onGameEditClick=function(e){var t=Object(r.a)({},e);t.date="string"===typeof e.date?e.date.substr(0,10):e.date.toISOString().substring(0,10);var a=s.findPlayerNotInGame(t);s.setState({editGame:t,existingPlayerId:a})},s.showGameData=function(e){s.setState({gameSummary:e})},s.updateOnProgressGame=function(){if(s.state.gameSummary){var e=s.props,t=e.group,a=e.getGame,r=e.provider,n=e.token,i=s.state.gameSummary.id;a(t.id,i,r,n).then((function(e){e.date=new Date(e.date),s.setState({gameSummary:e})}))}},s.deleteSelectedGame=function(){if(confirm("Are you sure?"))try{var e=s.props,t=e.group,a=e.provider,r=e.token,n=e.remoteDeleteGame,i=e.removeGroupGame,o=s.state.gameSummary.id;n(t.id,o,a,r).then((function(){s.setState({newGame:null,editGame:null,gameSummary:null,showErrorOnDeleteGame:null,showSuccessDeleteGame:!0}),setTimeout((function(){s.setState({showErrorOnDeleteGame:null,showSuccessDeleteGame:null}),i(o)}),100)})).catch((function(e){s.setState({showErrorOnDeleteGame:!0,showSuccessDeleteGame:null}),setTimeout((function(){s.setState({showErrorOnDeleteGame:null,showSuccessDeleteGame:null})}),100)}))}catch(c){console.error("deleteSelectedGame error",c)}},s.findPlayerNotInGame=function(e){var t=s.props.group,a={},r={};t.players.forEach((function(e){a[e.id]=e})),e.playersData.forEach((function(e){r[e.playerId]=e}));var n=t.players.find((function(e){return!r[e.id]}));return n?n.id:null},s.getGameDiff=function(e){return e.playersData.map((function(e){return e.buyIn})).reduce((function(e,t){return e+t}),0)-e.playersData.map((function(e){return e.cashOut})).reduce((function(e,t){return e+t}),0)},s.getGamePot=function(e){return e.playersData.reduce((function(e,t){return e+t.buyIn}),0)},s.getGamesSummary=function(){return Object(M.jsx)(ae,{game:s.state.gameSummary,group:s.props.group,back:function(){return s.setState({editGame:null,gameSummary:null})},edit:function(){return s.onGameEditClick(s.state.gameSummary)},delete:s.deleteSelectedGame})},s.imageIndex=0,s.imagesCount=7,s.backgroundImage="url(".concat(e.group.imageUrl||"poker.jpg",")"),s.state={newGame:null,editGame:null,gameSummary:null,showErrorOnDeleteGame:null,showSuccessDeleteGame:null},setTimeout((function(){e.setClearAll(s.clearAll)}),100),s}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.group,a=t.games;if(this.state.newGame)return Object(M.jsx)(be,{group:t,close:this.closeCreateGameForm,newGame:this.state.newGame,remoteCreateGame:f,updateGroupGame:this.props.updateGroupGame,user:this.props.user,provider:this.props.provider,token:this.props.token});if(this.state.editGame)return Object(M.jsx)(ve,{editGame:this.state.editGame,group:t,close:this.closeEditGameForm,remoteUpdateGame:O,updateGroupGame:this.props.updateGroupGame,updateImage:this.props.updateImage,user:this.props.user,provider:this.props.provider,token:this.props.token});if(this.state.gameSummary){var r=this.state.gameSummary;return r.ready?this.getGamesSummary():Object(M.jsx)(ge,{deleteSelectedGame:this.deleteSelectedGame,updateImage:this.props.updateImage,group:t,user:this.props.user,gameId:r.id,game:r,onBack:function(){return e.setState({gameSummary:null})},updateOnProgressGame:this.updateOnProgressGame,onGameEditClick:function(){return e.onGameEditClick(r)}})}var n=a.sort((function(e,t){return e.date>t.date?-1:1})).map((function(a,r){var n,s,i,o,c,l=a.ready,u=e.getGamePot(a),d={backgroundImage:"url(".concat(a.imageUrl||e.getImage(),")"),borderRadiusTop:"50px"};if(l){n=a.mvpPlayerId,s=t.players.find((function(e){return e.id===n}));var m=a.playersData.find((function(e){return e.playerId===n})),p=m.cashOut-m.buyIn;i=s?s.name?s.name:s.firstName?"".concat(s.firstName," ").concat(s.familyName):null:null,o="+".concat(p),(c=s?s.imageUrl:null)&&!a.imageUrl&&(d.backgroundImage="url(".concat(c,"), url(").concat(e.getImage(),")"),d.backgroundSize=xe?"60px 100px, cover":"160px 280px, cover",d.backgroundRepeat="no-repeat, repeat",d.backgroundPosition="right top",d.backgroundBlendMode="luminosity, normal")}return Object(M.jsxs)("div",{className:"game-item-div ".concat(l?"":"game-item-div-not-ready"),onClick:function(){return e.showGameData(a)},children:[Object(M.jsxs)("div",{className:"game-item-div-inner",style:d,children:[Object(M.jsx)("div",{children:Object(M.jsx)("b",{children:e.gameDateToString(a)})}),Object(M.jsxs)("div",{className:"group-description",children:[a.description," "]}),Object(M.jsxs)("div",{className:"my-group",children:[u," in pot"]})]},a.id),Object(M.jsxs)("div",{className:"game-extra-data",children:[Object(M.jsxs)("div",{children:[" ",a.playersData.length," players "]}),Object(M.jsxs)("div",{className:"game-not-ready-text",children:[l?"":"GAME NOT READY"," "]}),Object(M.jsx)("div",{className:"game-mvp-text",children:l&&s&&i?Object(M.jsxs)("span",{children:[Object(M.jsx)("b",{children:"MVP"}),xe?Object(M.jsx)("div",{}):Object(M.jsx)("span",{}),Object(M.jsx)("img",{src:c,className:"game-mvp"}),i," ",o]}):Object(M.jsx)("span",{})})]})]},a.id)})),s=this.state,i=s.showErrorOnDeleteGame,o=s.showSuccessDeleteGame;return Object(M.jsx)("div",{id:"all-games-div",children:Object(M.jsxs)("div",{className:"row",children:[Object(M.jsx)("div",{className:"col-xs-6",children:Object(M.jsx)("div",{className:"game-item-div",onClick:this.showCreateGame,children:Object(M.jsx)("img",{src:"plus.png",className:"game-item-div-plus-sign"})})}),n,i&&Object(M.jsx)(se.a,{message:"failed to remove game"}),o&&Object(M.jsx)(ye,{message:"game was removed"})]})})}}]),a}(c.Component);function Ge(){return(Ge=Object(d.a)(u.a.mark((function e(t,a,r,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,s){var i={method:"POST",url:"".concat(h.a,"/groups/").concat(t,"/players"),body:JSON.stringify(a),headers:{provider:r,"x-auth-token":n,"Content-Type":"application/json"}};p()(i,(function(t,a,r){if(t||a.statusCode>=400){if(t)return console.error("request cb error",t),s("failed to create new player");var n=JSON.parse(r);return console.error("failed to create new player"),s(n.title)}return e(JSON.parse(r))}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ie=function(e,t,a,r){return Ge.apply(this,arguments)};function Se(){return(Se=Object(d.a)(u.a.mark((function e(t,a,r,n,s){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var o={method:"PATCH",url:"".concat(h.a,"/groups/").concat(t,"/players/").concat(a),body:JSON.stringify(r),headers:{provider:n,"x-auth-token":s,"Content-Type":"application/json"}};p()(o,(function(t,a,r){if(t||a.statusCode>=400){if(t)return console.error("request cb error",t),i("failed to update player");var n=JSON.parse(r);return console.error("failed to update player"),i(n.title)}return e(JSON.parse(r))}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ne=function(e,t,a,r,n){return Se.apply(this,arguments)};function Ce(){return(Ce=Object(d.a)(u.a.mark((function e(t,a,r,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,s){var i={method:"DELETE",url:"".concat(h.a,"/groups/").concat(t,"/players/").concat(a),headers:{provider:r,"x-auth-token":n,"Content-Type":"application/json"}};p()(i,(function(t,a,r){if(t||a.statusCode>=400){if(t)return console.error("request cb error",t),s("failed to delete player");var n=JSON.parse(r);return console.error("failed to delete player",n),s(n.title)}return e()}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ke=function(e,t,a,r){return Ce.apply(this,arguments)},Pe=a(103),De=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),Ee=document.getElementsByTagName("body")[0],Te=window.innerWidth||document.documentElement.clientWidth||Ee.clientWidth,Ae=P.ANON_URL,Ue=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(n.a)(this,a);var s=(r=t.call(this,e)).props.player,i=r.props.group,o=s.id;return r.playerGames=i.games.map((function(e){var t=e.playersData.find((function(e){return e.playerId===o}));return!!t&&{game:e,playerData:t}})).filter((function(e){return!!e})).sort((function(e,t){return e.game.date<t.game.date?-1:1})),r.yearsObject={},r.playerGames.forEach((function(e,t){var a=e.game.date.getYear()+1900;r.yearsObject[a]?r.yearsObject[a].to=t:r.yearsObject[a]={from:t,to:t}})),r.firstGame=r.playerGames.length>0?r.playerGames[0]:null,r.state={sliderValues:{min:0,max:r.playerGames.length-1}},r}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.player,a=this.props.group.isAdmin,r=this.playerGames,n=this.firstGame,s=r.map((function(t,a){var r=t.game,n=t.playerData;return e.state.sliderValues.min<=a&&a<=e.state.sliderValues.max?Object(M.jsxs)("div",{className:"player-game-data",children:[("string"===typeof r.date?new Date(r.date):r.date).AsGameName()," ",Object(M.jsx)("span",{className:"gray-seprator",children:" |"}),De&&r.description,De&&Object(M.jsx)("span",{className:"gray-seprator",children:" |"}),De&&Object(M.jsx)("br",{}),"buy-in: ",n.buyIn," ",Object(M.jsx)("span",{className:"gray-seprator",children:" |"}),"cash-out: ",n.cashOut," ",Object(M.jsx)("span",{className:"gray-seprator",children:" |"}),"balance: ",n.cashOut-n.buyIn,!De&&Object(M.jsx)("span",{className:"gray-seprator",children:" |"}),!De&&r.description]},r.date):Object(M.jsx)("div",{},r.date)})),i=Object(M.jsx)("div",{}),o=t.name,c=0,l=0;if(r.length>0){var u=[Object(Pe.a)({name:" B.C. "},o,0)];r.forEach((function(t,a){var r={name:t.game.date.AsGameName()},n=t.playerData;c+=n.cashOut-n.buyIn,e.state.sliderValues.min<=a&&a<=e.state.sliderValues.max&&(l+=n.cashOut-n.buyIn,r[o]=l,u.push(r))})),i=Object(M.jsx)("div",{className:"col-xs-11 ",children:Object(M.jsxs)(k.c,{className:"gameGraphLineChart",width:De?Te:.97*Te,height:De?260:500,data:u,children:[Object(M.jsx)(k.e,{dataKey:"name"}),Object(M.jsx)(k.f,{}),Object(M.jsx)(k.a,{strokeDasharray:"0 40"}),Object(M.jsx)(k.d,{y:0,label:"Zero",stroke:"red"}),Object(M.jsx)(k.b,{className:"graphLine",type:"monotone",dataKey:o,stroke:"black"},o)]})})}var d=Object.keys(this.yearsObject).sort().map((function(t){return Object(M.jsx)($.a,{className:"year-button",onClick:function(){return e.setState({sliderValues:{min:e.yearsObject[t].from,max:e.yearsObject[t].to}})},children:t},"year-".concat(t))}));return console.log("player",t),Object(M.jsxs)("div",{className:"playerSummary",children:[Object(M.jsxs)("div",{className:"playerSummaryHeader",children:[Object(M.jsxs)("div",{children:["name: ",t.name]}),Object(M.jsxs)("div",{children:["email: ",t.email]}),n?Object(M.jsxs)("div",{children:[Object(M.jsxs)("div",{children:["playing since ",n.game.date.AsGameName()]}),Object(M.jsxs)("div",{children:["balance: ",c," (",r.length," games)"]})]}):Object(M.jsx)("div",{children:"no games yet"}),Object(M.jsx)("img",{alt:"",className:"playerPageImage",src:t.imageUrl||Ae}),Object(M.jsx)(B,{group:this.props.group,playerId:this.props.player.id})]}),Object(M.jsx)("hr",{}),n&&Object(M.jsxs)("div",{children:[Object(M.jsxs)("div",{children:[Object(M.jsx)("b",{children:"Date range specific data:"}),Object(M.jsx)("br",{})]}),Object(M.jsxs)("div",{children:["From ",this.playerGames[this.state.sliderValues.min].game.date.AsGameName()," to ",this.playerGames[this.state.sliderValues.max].game.date.AsGameName()]}),Object(M.jsx)("div",{children:Object(M.jsx)(U.a,{className:"InputRange",step:1,formatLabel:function(){return""},maxValue:this.playerGames.length-1,minValue:0,value:this.state.sliderValues,onChange:function(t){e.state.sliderValues.min<e.state.sliderValues.max&&e.setState({sliderValues:t})}})}),Object(M.jsxs)("div",{children:["balance: ",l," (",this.state.sliderValues.max-this.state.sliderValues.min+1," games)"]}),Object(M.jsx)("div",{children:i}),Object(M.jsx)("div",{children:d})]}),Object(M.jsxs)("div",{className:"buttons-section",children:[Object(M.jsx)($.a,{onClick:this.props.back,children:"Back"}),a&&Object(M.jsx)($.a,{onClick:this.props.edit,className:"left-margin",children:"Edit"}),a&&0===r.length&&Object(M.jsx)(ee.a,{onClick:this.props.delete,className:"left-margin",children:"Delete"})]}),Object(M.jsx)("div",{className:"playerGames",children:s})]})}}]),a}(c.Component),Me="http://localhost:3000"===window.location.origin?"http://www.poker-stats.com":window.location.origin,Be=P.ANON_URL,Fe="".concat(Me,"/").concat(Be),Re=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var s;Object(n.a)(this,a),(s=t.call(this,e)).setupPlayers=function(){},s.showPlayerData=function(e){s.setState({playerSummary:e})},s.showCreatePlayer=function(){s.setState({newPlayer:{name:"",email:""}})},s.onPlayerEditClick=function(e){s.setState({editPlayer:e})},s.onPlayerDeleteClick=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!confirm("Are you sure?")){e.next=11;break}return e.prev=1,e.next=4,ke(s.props.group.id,t,s.props.provider,s.props.token);case 4:s.props.updatePlayerRemoved(t),s.setState({playerSummary:null}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("deletePlayerById error",e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),s.createNewPlayer=function(){var e=s.props,t=e.group,a=e.provider,r=e.token,n=e.updatePlayerData,i={name:s.state.newPlayer.name,email:s.state.newPlayer.email};console.log("calling create player with body:",i),Ie(t.id,i,a,r).then((function(e){s.setState({newPlayer:null,editPlayer:null,playerSummary:null}),n(e)}))},s.getNewPlayerSection=function(){var e=s.state.newPlayer.name&&s.state.newPlayer.name.length>0;return Object(M.jsxs)("div",{id:"new-player-form",children:[Object(M.jsx)("h2",{children:" Create a new player. "}),Object(M.jsxs)("div",{className:"new-player-section",children:["name:",Object(M.jsx)("input",{type:"text",id:"newGameExtra",className:"bordered-input left-margin left-pad",value:s.state.newPlayer.name,onChange:function(e){var t=Object(r.a)({},s.state.newPlayer);t.name=e.target.value,s.setState({newPlayer:t})}})]}),Object(M.jsxs)("div",{className:"new-player-section",children:["email:",Object(M.jsx)("input",{type:"text",id:"newGameExtra",className:"bordered-input left-margin left-pad",value:s.state.newPlayer.email,onChange:function(e){var t=Object(r.a)({},s.state.newPlayer);t.email=e.target.value,s.setState({newPlayer:t})}})]}),Object(M.jsxs)("div",{className:"new-player-section",children:[Object(M.jsx)($.a,{className:"button left-margin",onClick:function(){return s.setState({newPlayer:null})},children:" Cancel "}),Object(M.jsx)(je.a,{className:"button left-margin",onClick:s.createNewPlayer,disabled:!e,children:" Create "})]})]})},s.saveEditedPlayer=function(){var e=s.props,t=e.group,a=e.provider,r=e.token,n=e.updatePlayerData,i={id:s.state.editPlayer.id,name:s.state.editPlayer.name,email:s.state.editPlayer.email,imageUrl:s.state.editPlayer.imageUrl};console.log("saveEditedPlayer player",i),Ne(t.id,i.id,i,a,r).then((function(e){s.setState({newPlayer:null,editPlayer:null,playerSummary:null}),n(e),setTimeout((function(){console.log("1 sec later"),window.location.reload(!1)}),1e3)}))},s.uploadImage=function(){var e=Object(d.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={playerIds:[],gameIds:[],groupIds:[]},e.abrupt("return",me(t,a,s.props.provider,s.props.token));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.onReaderLoad=function(){var e=Object(d.a)(u.a.mark((function e(t){var a,n,i,o,c,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.props,n=a.provider,i=a.token,e.prev=1,e.next=4,me(t.target.result,{playerIds:[],gameIds:[],groupIds:[]},!0,n,i);case 4:o=e.sent,console.log("res",o),c=o.image,(l=Object(r.a)({},s.state)).editPlayer.imageUrl=c,s.setState(l),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log("e",e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),s.readURL=function(e){if(e.preventDefault(),e.target.files&&e.target.files[0]){var t=new FileReader;t.onload=s.onReaderLoad,t.readAsDataURL(e.target.files[0])}},s.getPlayerEdit=function(){return console.log("EditPlayer render"),Object(M.jsxs)("div",{className:"playerEditForm",children:[Object(M.jsxs)("div",{className:"playerSummaryHeader",children:[Object(M.jsxs)("div",{children:["name: ",s.state.editPlayer.name,Object(M.jsx)("input",{type:"text",id:"playerName",className:"bordered-input left-margin left-pad",value:s.state.editPlayer.name,onChange:function(e){var t=Object(r.a)({},s.state.editPlayer);t.name=e.target.value||"",s.setState({editPlayer:t})}})]}),Object(M.jsxs)("div",{children:["email:",Object(M.jsx)("input",{type:"text",id:"playerEmail",className:"bordered-input left-margin left-pad",value:s.state.editPlayer.email,onChange:function(e){var t=Object(r.a)({},s.state.editPlayer);t.email=e.target.value||"",s.setState({editPlayer:t})}})]}),Object(M.jsxs)("div",{children:["image URL:",Object(M.jsx)("input",{type:"text",id:"playerImage",className:"bordered-input left-margin left-pad",value:s.state.editPlayer.imageUrl||"",onChange:function(e){var t=Object(r.a)({},s.state.editPlayer);t.imageUrl=e.target.value||"",s.setState({editPlayer:t})}})]}),Object(M.jsxs)("div",{children:["OR ",Object(M.jsx)("input",{type:"file",accept:".png,.jpg,.jpeg",id:"imgInput",onChange:s.readURL})]}),s.state.editPlayer.imageUrl&&s.state.editPlayer.imageUrl.length>0&&Object(M.jsx)("img",{alt:"",className:"playerPageImage",src:s.state.editPlayer.imageUrl})]}),Object(M.jsxs)("div",{className:"buttons-section",children:[Object(M.jsx)($.a,{onClick:function(){return s.setState({editPlayer:null})},children:"Back"}),Object(M.jsx)(je.a,{onClick:s.saveEditedPlayer,className:"left-margin",children:"Save"})]})]})};var i=s.props.group.players;return s.PLAYERS=(i||[]).sort((function(e,t){return e.gamesCount>t.gamesCount?-1:1})).map((function(e,t){var a={backgroundImage:"url(".concat(e.imageUrl||Fe,")"),borderRadiusTop:"50px"};return Object(M.jsx)("div",{className:"player-item-div",onClick:function(){return s.showPlayerData(e)},children:Object(M.jsxs)("div",{className:"player-item-div-inner",style:a,children:[Object(M.jsx)("div",{children:Object(M.jsx)("b",{children:e.name})}),e.gamesCount?Object(M.jsxs)("div",{children:[Object(M.jsxs)("div",{children:["  ",e.gamesCount," games"]}),Object(M.jsxs)("div",{children:["  ",e.balance,"\u20aa "]})]}):Object(M.jsx)("div",{children:"no games yet"})]})},"".concat(t,"_").concat(e.id))})),s.state={newPlayer:null,editPlayer:null,playerSummary:null},s}return Object(s.a)(a,[{key:"render",value:function(){var e=this;return console.log("PlayersTab render",this.props),this.state.newPlayer?this.getNewPlayerSection():this.state.editPlayer?this.getPlayerEdit():this.state.playerSummary?Object(M.jsx)(Ue,{player:this.state.playerSummary,group:this.props.group,back:function(){return e.setState({playerSummary:null})},edit:function(){return e.onPlayerEditClick(e.state.playerSummary)},delete:function(){return e.onPlayerDeleteClick(e.state.playerSummary.id)}}):Object(M.jsx)("div",{id:"all-games-div",children:Object(M.jsxs)("div",{className:"row",children:[Object(M.jsx)("div",{className:"col-xs-6",children:Object(M.jsx)("div",{className:"player-item-div",onClick:this.showCreatePlayer,children:Object(M.jsx)("img",{src:"plus.png",className:"player-item-div-plus-sign"})})}),this.PLAYERS]})})}}]),a}(c.Component),Le=a(63),Je=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).logout=function(){r.setState({showMenu:!1}),r.props.logout()},r.goHome=function(){r.setState({showMenu:!1}),r.props.goHome()},r.onKeyChange=function(e){r.clearGamesTabSelections(),r.setState({tabKey:e})},r.handleNewPlayerChange=function(e){r.setState({existingPlayerId:e})},r.showImageUploaderForm=function(e){var t=e.gameId;r.setState({imageUploaderData:{gameId:t}})},r.hideImageUploaderForm=function(){r.setState({imageUploaderData:null})},r.getHeader=function(){var e=r.props.group,t=[];return e.isAdmin&&t.push(Object(M.jsx)(G.a,{onClick:function(){return r.props.editGroup(e)},children:"Edit Group"},"menuItem1")),t.push(Object(M.jsx)(G.a,{onClick:r.goHome,children:"Home"},"menuItem5")),t.push(Object(M.jsx)(G.a,{onClick:r.logout,children:"Logout"},"menuItem6")),t.push(Object(M.jsx)(G.a,{onClick:function(){},children:Object(M.jsxs)("div",{children:[Object(M.jsx)("hr",{})," ",Object(M.jsx)("span",{className:"version-menu-item-text",children:"version: "}),Object(M.jsx)("span",{className:"version-menu-item-number",children:Le.a})]})},"menuItem6")),Object(M.jsxs)("div",{id:"app-header",children:[Object(M.jsx)(S.a,{id:"menuIcon",fontSize:"inherit",className:"menu-icon",onClick:function(){return r.setState({showMenu:!r.state.showMenu})}}),r.state.showMenu&&Object(M.jsx)(w.a,{id:"simple-menu",anchorEl:function(){return document.getElementById("menuIcon")},keepMounted:!0,open:!0,onClose:function(){return r.setState({showMenu:!r.state.showMenu})},children:t}),Object(M.jsxs)("span",{id:"app-header-text",children:[Object(M.jsx)("img",{src:"pokerStatsLogoWithSheep.png",className:"sheep-logo"}),"Group Page"]})]})},r.getNewGameSection=function(){var e=r.state.newGame.date&&10===r.state.newGame.date.length;return Object(M.jsxs)("div",{id:"new-game-form",children:[Object(M.jsx)("h2",{children:" Create a new game. "}),Object(M.jsxs)("div",{className:"new-game-section",children:["Game date:",Object(M.jsx)("input",{className:"left-margin",type:"date",id:"newGameDate",min:"2010-01-01",max:"2050-01-01",value:r.state.newGame.date,onChange:r.handleNewGameDateChange})]}),Object(M.jsxs)("div",{className:"new-game-section",children:["description:",Object(M.jsx)("input",{type:"text",id:"newGameExtra",className:"bordered-input left-margin left-pad",value:r.state.newGame.description,onChange:r.handleNewGameDescriptionChange})]}),Object(M.jsxs)("div",{className:"new-game-section",children:[Object(M.jsx)($.a,{className:"button left-margin",onClick:function(){return r.setState({newGame:null})},children:" Cancel "}),Object(M.jsx)(je.a,{className:"button left-margin",onClick:r.createNewGame,disabled:!e,children:" Create "})]})]})},r.getGamesSummary=function(){return Object(M.jsx)(ae,{game:r.state.gameSummary,group:r.props.group,back:function(){return r.setState({editGame:null,gameSummary:null})},edit:function(){return r.onGameEditClick(r.state.gameSummary)},delete:r.deleteSelectedGame})},r.imageIndex=0,r.imagesCount=7,r.backgroundImage="url(".concat(e.group.imageUrl||"poker.jpg",")"),r.clearGamesTabSelections=function(){},r.state={tabKey:"summary",existingPlayerId:null},r}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.group;if(this.state.imageUploaderData)return Object(M.jsx)(ce.a,Object(r.a)(Object(r.a)({group:t},this.state.imageUploaderData),{},{close:this.hideImageUploaderForm,uploadImage:this.uploadImage}));var a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),n=a?7:8,s=this.getHeader(),i={backgroundImage:this.backgroundImage};return Object(M.jsxs)("div",{id:"container",className:"group-page",children:[s,Object(M.jsx)("div",{id:"group-image-title",className:"group-image-title",style:i,children:Object(M.jsx)("div",{className:"row",children:Object(M.jsxs)("div",{className:"col-xs-8 event-page-title",children:[Object(M.jsx)("div",{children:t.name}),Object(M.jsx)("div",{className:"event-page-description",children:t.description})]})})}),Object(M.jsx)("div",{id:"group-page-data",children:Object(M.jsxs)(N.a,{defaultActiveKey:"profile",id:"uncontrolled-tab-example",style:{fontSize:a?"0.8em":"1em"},activeKey:this.state.tabKey,onSelect:this.onKeyChange,variant:"pills",children:[Object(M.jsx)(C.a,{eventKey:"summary",title:"summary",children:Object(M.jsx)(q,{group:t,playersCount:n,IsGroupSummary:!0})}),Object(M.jsx)(C.a,{eventKey:"games",title:"Games",children:Object(M.jsx)("div",{id:"games-tab",children:Object(M.jsx)(we,{group:t,remoteCreateGame:f,remoteUpdateGame:O,remoteDeleteGame:x,getGame:j,removeGroupGame:this.props.removeGame,updateGroupGame:this.props.updateGame,removeGame:this.props.removeGame,updateImage:this.props.updateImage,setClearAll:function(t){e.clearGamesTabSelections=t},user:this.props.user,provider:this.props.provider,token:this.props.token})})}),Object(M.jsx)(C.a,{eventKey:"players",title:"Players",children:Object(M.jsx)("div",{id:"players-tab",children:Object(M.jsx)(Re,{group:t,updatePlayerData:this.props.updatePlayerData,updatePlayerRemoved:this.props.updatePlayerRemoved,user:this.props.user,provider:this.props.provider,token:this.props.token})})}),Object(M.jsx)(C.a,{eventKey:"images",title:"Images",children:Object(M.jsx)("div",{id:"images-tab",children:Object(M.jsx)(pe,{group:t,provider:this.props.provider,token:this.props.token,user:this.props.user,removeImage:this.props.removeImage,uploadImage:this.props.uploadImage,updateImage:this.props.updateImage})})})]})})]})}}]),a}(c.Component);t.a=Je},414:function(e,t,a){"use strict";var r=a(5),n=a.n(r),s=a(7),i=a(31),o=a(16),c=a(19),l=a(18),u=a(17),d=a(1),m=(a(146),a(107)),p=a(56),h=a(33),g=a(413),j=a(14),b=a.n(j);a(15);function f(){return(f=Object(s.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){var r={};t.headers.forEach((function(e){if(e.includes(":")){var t=e.split(":"),a=Object(g.a)(t,2),n=a[0],s=a[1];r[n.trim()]=s.trim()}}));var n={method:t.method,url:t.url,headers:r};t.body&&(n.body=JSON.stringify(t.body)),b()(n,(function(t,a,r){var n;try{n=JSON.parse(r)}catch(s){console.log("e",s)}return e({statusCode:a.statusCode,body:r,headers:a.headers,bodyObj:n,error:t})}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=function(e){return f.apply(this,arguments)},O=a(249),y=a.n(O),x=a(2),w=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).onKeyChange=function(e){if("+"===e){console.log("+ was pressed");var t=Object(i.a)(r.state.tabs);t.push({name:"Tab ".concat(r.state.tabs.length+1),method:"GET",url:"",headers:[]}),r.setState({tabs:t,tabKey:t[t.length-1].name})}else r.setState({tabKey:e})},r.state={tabKey:"Tab 1",tabs:[{name:"Tab 1",method:"GET",url:"https://www.poker-stats.com/api/v2/groups/",headers:["provider: google","x-auth-token: ****"]}]},r}return Object(c.a)(a,[{key:"sendRequest",value:function(){var e=Object(s.a)(n.a.mark((function e(){var t,a,r,s,i,o,c,l=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({bodyObj:null,statusCode:null,error:null,headers:null}),t=this.state.tabs.find((function(e){return e.name===l.state.tabKey})),console.log("sendRequest tabData",t),t||console.error("sendRequest no tabData found!",this.state.tabs,this.state.tabKey),e.next=6,v(t);case 6:a=e.sent,r=a.statusCode,s=a.body,i=a.headers,o=a.bodyObj,c=a.error,console.log("statusCode",r),console.log("body",s),console.log("bodyObj",o),console.log("error",c),console.log("headers",i),this.setState({bodyObj:o,statusCode:r,error:c,headers:i});case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.tabs.map((function(t){return Object(x.jsxs)(p.a,{eventKey:t.name,title:t.name,children:[Object(x.jsxs)("div",{children:[Object(x.jsxs)("select",{className:"postman-method-combo",name:"method",value:t.method,onChange:function(a){var r=Object(i.a)(e.state.tabs);r.find((function(e){return e.name===t.name})).method=a.target.value,e.setState({tabs:r})},children:[Object(x.jsx)("option",{value:"GET",children:"GET "},"_comboVals_get"),Object(x.jsx)("option",{value:"POST",children:"POST "},"_comboVals_post"),Object(x.jsx)("option",{value:"PUT",children:"PUT "},"_comboVals_put"),Object(x.jsx)("option",{value:"DELETE",children:"DELETE "},"_comboVals_delete"),Object(x.jsx)("option",{value:"PATCH",children:"PATCH "},"_comboVals_patch")]}),Object(x.jsx)("input",{className:"postman-url",type:"text",value:t.url,onChange:function(a){var r=Object(i.a)(e.state.tabs);r.find((function(e){return e.name===t.name})).url=a.target.value,e.setState({tabs:r})}}),Object(x.jsx)(h.a,{className:"button left-margin",onClick:function(){return e.sendRequest()},children:" Send"})]}),Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{children:"  Headers:"}),Object(x.jsx)("div",{children:t.headers.map((function(a,r){var n=a.split(":")[0].trim(),s=a.split(":")[1].trim();return Object(x.jsxs)("div",{children:[Object(x.jsx)("input",{className:"postman-header postman-header-key",type:"text",value:n,onChange:function(a){var n=Object(i.a)(e.state.tabs);n.find((function(e){return e.name===t.name})).headers[r]="".concat(a.target.value,":").concat(s),e.setState({tabs:n})}}),Object(x.jsx)("input",{className:"postman-header postman-header-value",type:"text",value:s,onChange:function(a){var s=Object(i.a)(e.state.tabs);s.find((function(e){return e.name===t.name})).headers[r]="".concat(n,":").concat(a.target.value),e.setState({tabs:s})}}),r===t.headers.length-1?Object(x.jsx)("div",{className:"add-header-col",onClick:function(){var a=Object(i.a)(e.state.tabs);a.find((function(e){return e.name===t.name})).headers.push(":"),e.setState({tabs:a})},children:"+"}):Object(x.jsx)("div",{})]})}))})]}),e.state.statusCode?Object(x.jsxs)("div",{className:"postman-result-div",children:[Object(x.jsxs)("div",{children:["result status code: ",e.state.statusCode]}),Object(x.jsxs)("div",{children:["result body:",Object(x.jsx)("div",{children:Object(x.jsx)(y.a,{data:e.state.bodyObj})})]}),Object(x.jsxs)("div",{children:["result headers",Object(x.jsx)("div",{children:Object(x.jsx)(y.a,{data:e.state.headers})})]})]}):Object(x.jsx)("div",{})]},t.name)}));return t.length<12&&t.push(Object(x.jsx)(p.a,{eventKey:"+",title:"+"},"+")),Object(x.jsxs)("div",{id:"postman",children:[Object(x.jsx)("div",{id:"postman-header",children:"Postman"}),Object(x.jsx)("div",{id:"postman-div-body",children:Object(x.jsx)(m.a,{defaultActiveKey:"profile",id:"uncontrolled-tab-example2",style:{fontSize:"1em"},activeKey:this.state.tabKey,onSelect:this.onKeyChange,variant:"pills",children:t})})]})}}]),a}(d.Component);t.a=w},415:function(e,t,a){"use strict";var r=a(5),n=a.n(r),s=a(7),i=a(16),o=a(19),c=a(18),l=a(17),u=a(1),d=a(398),m=a.n(d),p=a(399),h=a(14),g=a.n(h),j=a(15);function b(){return(b=Object(s.a)(n.a.mark((function e(t,a){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n={url:"".concat(j.a,"/groups/"),headers:{provider:t,"x-auth-token":a,"Content-Type":"application/json"}};g()(n,(function(n,s,i){if(n||s.statusCode>=400){if(n)return console.error("request cb error",n),r("failed to connect, server might be down");var o=JSON.parse(i);return console.error("request cb error body",o),r(o.title)}if(s&&s.headers&&s.headers["x-user-context"]){var c=s.headers["x-user-context"],l=JSON.parse(decodeURI(c)),u=JSON.parse(i).results;return e({groups:u,userContext:l,provider:t,token:a})}return console.error("request cb no header"),r("server response is missing the user context")}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var f=function(e,t){return b.apply(this,arguments)},v=a(168),O=a(63),y=a(2),x="https:"===window.location.protocol,w=x,G=x&&!!window.location.search&&window.location.search.includes("fb=true"),I=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).onFailure=function(t){console.error("App onFailure",t),e.setState({error:t})},e.performLogin=function(){var t=Object(s.a)(n.a.mark((function t(a,r){var s,i,o,c,l=arguments;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=!(l.length>2&&void 0!==l[2])||l[2],t.prev=1,t.next=4,f(a,r);case 4:return i=t.sent,o=localStorage.getItem("authData"),c=o?JSON.parse(o).issueDate:new Date,localStorage.setItem("authData",JSON.stringify({provider:a,token:r,issueDate:c})),t.abrupt("return",e.props.onLogin(i));case 11:if(t.prev=11,t.t0=t.catch(1),localStorage.removeItem("authData"),!s){t.next=18;break}return t.abrupt("return",e.onFailure(t.t0));case 18:return t.abrupt("return",e.onFailure(null));case 19:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e,a){return t.apply(this,arguments)}}(),e.facebookResponse=function(t){t.accessToken?e.performLogin("facebook",t.accessToken,!0):e.onFailure("login failed")},e.googleResponse=function(t){t.accessToken?e.performLogin("google",t.accessToken,!0):e.onFailure("login failed")},e.state={error:null},G&&setTimeout((function(){try{var e=document.getElementById("fbButton");e&&e.click()}catch(t){console.log("e",t)}}),1e3),e}return Object(o.a)(a,[{key:"render",value:function(){var e=localStorage.getItem("authData");if(e){var t=JSON.parse(e),a=t.provider,r=t.token,n=t.issueDate;if(!((new Date).getTime()-new Date(n).getTime()>864e5))return this.performLogin(a,r,!1),Object(y.jsx)(v.a,{});localStorage.removeItem("authData")}var s=Object(y.jsx)(p.GoogleLogin,{clientId:"819855379342-js3mkfftkk25qopes38dcbhr4oorup45.apps.googleusercontent.com",onSuccess:this.googleResponse,onFailure:this.onFailure,render:function(e){return Object(y.jsx)("div",{className:"login-button login-button-google",onClick:e.onClick,children:" LOGIN WITH GOOGLE"})}}),i=w?Object(y.jsx)(m.a,{disableMobileRedirect:!0,appId:"2487592561563671",autoLoad:!1,fields:"name,email,picture",callback:this.facebookResponse,render:function(e){return Object(y.jsx)("div",{id:"fbButton",className:"login-button login-button-fb",onClick:e.onClick,children:" LOGIN WITH FACEBOOK"})}}):Object(y.jsx)("div",{className:"login-button login-button-fb",onClick:function(){window.location="https://www.poker-stats.com?fb=true"},children:" LOGIN WITH FACEBOOK"});return Object(y.jsxs)("div",{id:"login-page",children:[Object(y.jsxs)("div",{id:"version",children:["version: ",O.a]}),Object(y.jsx)("div",{children:Object(y.jsx)("img",{id:"sheep-img",src:"sheep.png",alt:"sheep"})}),Object(y.jsx)("div",{children:Object(y.jsx)("img",{id:"pokerStatsLogo",src:"pokerStatsLogo.png",alt:"Chips"})}),Object(y.jsx)("div",{children:Object(y.jsx)("img",{id:"chips-img",src:"https://res.cloudinary.com/www-poker-stats-com/image/upload/v1618731943/Casino-Poker-Chips-croped.png",alt:"Chips"})}),i,s,Object(y.jsx)("div",{id:"loginErrorSection",children:this.state.error?this.state.error:""})]})}}]),a}(u.Component);t.a=I},417:function(e,t,a){"use strict";a.r(t);var r=a(4),n=(a(1),a(26)),s=a.n(n),i=a(390),o=a(66),c=a(411),l=(a(994),a(2)),u={position:o.b.BOTTOM_CENTER,timeout:3e3,offset:"30px",transition:o.c.SCALE},d=function(){return Object(l.jsx)(o.a,Object(r.a)(Object(r.a)({template:c.a},u),{},{children:Object(l.jsx)(i.a,{})}))};s.a.render(Object(l.jsx)(d,{}),document.getElementById("root"))},440:function(e,t){},442:function(e,t){},451:function(e,t){},453:function(e,t){},478:function(e,t){},480:function(e,t){},481:function(e,t){},486:function(e,t){},488:function(e,t){},507:function(e,t){},519:function(e,t){},522:function(e,t){},527:function(e,t){},529:function(e,t){},53:function(e,t,a){"use strict";var r=a(4),n=(a(1),a(2));t.a=function(e){return Object(n.jsxs)("button",Object(r.a)(Object(r.a)({},e),{},{className:"".concat(e.className," confetti-button confetti-button-red"),onClick:function(t){t.preventDefault();try{t.target.classList.remove("animate")}catch(t){}try{t.target.classList.add("animate")}catch(t){}setTimeout((function(){try{t.target.classList.remove("animate")}catch(t){}}),700),setTimeout((function(){try{e.onClick(t)}catch(t){}}),500)},children:[" ",e.children]}))}},552:function(e,t){},63:function(e){e.exports=JSON.parse('{"a":"3.0.18"}')},65:function(e,t,a){"use strict";a(1);var r=a(66),n=a(2);t.a=function(e){var t=Object(r.d)(),a=e.message;return setTimeout((function(){t.error(a)}),1),Object(n.jsx)("div",{})}},79:function(e,t,a){"use strict";a(1);var r=a(66),n=a(2);t.a=function(e){var t=Object(r.d)(),a=e.message;return setTimeout((function(){t.success(a)}),1),Object(n.jsx)("div",{})}},994:function(e,t,a){}},[[417,1,2]]]);
//# sourceMappingURL=main.ea266c41.chunk.js.map